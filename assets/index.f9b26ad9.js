var mt=Object.defineProperty;var gt=(C,t,s)=>t in C?mt(C,t,{enumerable:!0,configurable:!0,writable:!0,value:s}):C[t]=s;var w=(C,t,s)=>(gt(C,typeof t!="symbol"?t+"":t,s),s);import{r as j,u as V,j as l,_ as K,a as ft,p as P,i as d,s as yt,N as J,b as m,S as F,C as D,F as L,H as Ct,M as dt,R as pt,c as Nt,d as St,e as kt,f as wt,g as vt,k as B,l as bt,A as It,m as xt,n as Ot,T as Et}from"./vendor.b0d57cfc.js";const jt=function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))e(i);new MutationObserver(i=>{for(const r of i)if(r.type==="childList")for(const o of r.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&e(o)}).observe(document,{childList:!0,subtree:!0});function s(i){const r={};return i.integrity&&(r.integrity=i.integrity),i.referrerpolicy&&(r.referrerPolicy=i.referrerpolicy),i.crossorigin==="use-credentials"?r.credentials="include":i.crossorigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function e(i){if(i.ep)return;i.ep=!0;const r=s(i);fetch(i.href,r)}};jt();const Ft="modulepreload",ut={},Tt="./",E=function(t,s){return!s||s.length===0?t():Promise.all(s.map(e=>{if(e=`${Tt}${e}`,e in ut)return;ut[e]=!0;const i=e.endsWith(".css"),r=i?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${e}"]${r}`))return;const o=document.createElement("link");if(o.rel=i?"stylesheet":Ft,i||(o.as="script",o.crossOrigin=""),o.href=e,document.head.appendChild(o),i)return new Promise((n,a)=>{o.addEventListener("load",n),o.addEventListener("error",()=>a(new Error(`Unable to preload CSS for ${e}`)))})})).then(()=>t())};const Mt=({value:C,onChange:t})=>{const[s,e]=j.exports.useState(C),[i,r]=j.exports.useState(!1),[o,n]=j.exports.useState(null);return V(()=>{o!==null&&(E(()=>import("./vendor.b0d57cfc.js").then(function(a){return a.q}),[]).then(({toast:a})=>a.error(o)),n(null))},1e4),l(K,{value:s,onValueChange:a=>{try{ft.exports.parse(a),r(!1),n(null)}catch(c){n(c.message),r(!0)}e(a),t(a)},highlight:a=>P.exports.highlight(a,P.exports.languages.json),padding:10,style:{fontFamily:'"Fira code", "Fira Mono", monospace',fontSize:12,background:i?"rgba(255, 0, 80, 0.7)":"#FFF",maxWidth:"300px"}})},X=class extends d.Control{constructor(t,s,e,i=!1){super(s);this.emitter=t,this.key=s,this.component=X.component;const r=e.data[s]||'{"name": "value"}';e.data[s]=r,e.data.output=r,this.props={readonly:i,value:r,onChange:o=>{this.setValue(o),this.emitter.trigger("process")}}}setValue(t){this.props.value=t,this.putData(this.key,t),this.putData("output",t),this.update()}};let R=X;w(R,"component",({value:t,onChange:s})=>l("div",{ref:e=>e&&e.addEventListener("pointerdown",i=>i.stopPropagation()),children:l(Mt,{value:t,onChange:e=>s(e)})}));class _t extends d.Component{constructor(t){super("JSON");w(this,"path",["New"]);this.socket=t}builder(t){const s=new d.Output("json","JSON",this.socket);return t.addControl(new R(this.editor,"json",t)).addOutput(s)}worker(t,s,e){e.json=t.data.json}}const Dt=({value:C,onChange:t})=>{const[s,e]=j.exports.useState(C),[i,r]=j.exports.useState(!1),[o,n]=j.exports.useState(null);return V(()=>{o!==null&&(E(()=>import("./vendor.b0d57cfc.js").then(function(a){return a.q}),[]).then(({toast:a})=>a.error(o)),n(null))},1e4),l(K,{value:s,onValueChange:a=>{try{yt.exports.parse(a),r(!1),n(null)}catch(c){n(c.message),r(!0)}e(a),t(a)},highlight:a=>P.exports.highlight(a,P.exports.languages.sql),padding:10,style:{fontFamily:'"Fira code", "Fira Mono", monospace',fontSize:12,background:i?"rgba(255, 0, 80, 0.7)":"#FFF",maxWidth:"300px"}})},Z=class extends d.Control{constructor(t,s,e,i=!1){super(s);this.emitter=t,this.key=s,this.component=Z.component;const r=e.data[s]||"SELECT * FROM users";e.data[s]=r,e.data.output=r,this.props={readonly:i,value:r,onChange:o=>{this.setValue(o),this.emitter.trigger("process")}}}setValue(t){this.props.value=t,this.putData(this.key,t),this.putData("output",t),this.update()}};let H=Z;w(H,"component",({value:t,onChange:s})=>l("div",{ref:e=>e&&e.addEventListener("pointerdown",i=>i.stopPropagation()),children:l(Dt,{value:t,onChange:e=>s(e)})}));class Pt extends d.Component{constructor(t){super("SQL");w(this,"path",["New"]);this.socket=t}builder(t){const s=new d.Output("sql","SQL",this.socket);return t.addControl(new H(this.editor,"sql",t)).addOutput(s)}worker(t,s,e){e.sql=t.data.sql}}class $t extends J{render(){const{bindSocket:t,bindControl:s}=this.props,{outputs:e,controls:i,inputs:r,selected:o}=this.state;return m("div",{className:`node ${o}`,style:{background:"grey"},children:[l("div",{className:"title",children:"Template"}),e.map(n=>m("div",{className:"output",children:[l("div",{className:"output-title",children:n.name}),l(F,{type:"output",socket:n.socket,io:n,innerRef:t})]},n.key)),i.map(n=>l(D,{className:"control",control:n,innerRef:s},n.key)),r.map(n=>m("div",{className:"input",children:[l(F,{type:"input",socket:n.socket,io:n,innerRef:t}),l("div",{className:"input-title",children:n.name})]},n.key))]})}}const tt=class extends d.Control{constructor(t,s,e,i=!1){super(s);this.emitter=t,this.keys=[],this.component=tt.component,this.props={readonly:i,value:"",onChange:()=>{}},e.data.output=""}setValue(t,s,e){this.props.value=s,this.putData("output",s),this.putData("contentType",e),Object.entries(t).forEach(([i,r])=>{r[0]&&this.putData(i,r[0])}),this.update()}};let U=tt;w(U,"component",({value:t,onChange:s})=>m(L,{children:[l("label",{style:{color:"white",display:"block",textAlign:"left"},children:"Preview"}),l("textarea",{value:t,rows:10,ref:e=>e&&e.addEventListener("pointerdown",i=>i.stopPropagation()),onChange:e=>s(String(e.target.value)),disabled:!0})]}));const Lt=window.pug;class Jt extends d.Component{constructor(t,s,e){super("Template");w(this,"path",["New"]);this.data.component=$t,this.dataSocket=t,this.templateSocket=s,this.htmlSocket=e}builder(t){const s=new d.Input("template","TemplateEngine",this.templateSocket),e=new d.Input("json","Data (JSON)",this.dataSocket),i=new d.Output("html","HTML",this.htmlSocket);return e.addControl(new R(this.editor,"json",t)),t.addInput(s).addInput(e).addControl(new U(this.editor,"template",t,!0)).addOutput(i)}worker(t,s,e){const i=s.json.length?s.json[0]:t.data.json,r=t.inputs.template.connections.filter(n=>(n==null?void 0:n.output)==="hbs"||(n==null?void 0:n.output)==="pug"),o=(()=>{var c;if(r.length===0)return"No TemplateEngine detected...";const n=r[0].output,a=(c=s.template)!=null&&c.length?s.template[0]:t.data.json;return n==="pug"?Lt.render(a,JSON.parse(i)):n==="hbs"?Ct.compile(a)(JSON.parse(i)):"Unknown TemplateEngine detected..."})();this.editor.nodes.find(n=>n.id===t.id).controls.get("template").setValue(s,o,"text/html; charset=utf-8"),e.html=o}}const At=({value:C,onChange:t})=>{const[s,e]=j.exports.useState(C),[i,r]=j.exports.useState(!1),[o,n]=j.exports.useState(null);return V(()=>{o!==null&&(E(()=>import("./vendor.b0d57cfc.js").then(function(a){return a.q}),[]).then(({toast:a})=>a.error(o)),n(null))},1e4),l("div",{className:"hasScrollbar",style:{overflowY:"auto",maxHeight:"500px"},children:l(K,{textareaClassName:"editorTextarea",preClassName:"line-numbers",value:s,onValueChange:a=>{E(()=>import("./vendor.b0d57cfc.js").then(function(c){return c.h}),[]).then(c=>{c.precompile(a),r(!1),n(null)}).catch(c=>{n(c.message),r(!0)}),e(a),t(a)},highlight:a=>P.exports.highlight(a,P.exports.languages.handlebars).split(`
`).map(c=>`<span class="container_editor_line_number">${c}</span>`).join(`
`),padding:10,style:{fontFamily:'"Fira code", "Fira Mono", monospace',fontSize:12,background:i?"rgba(255, 0, 80, 0.7)":"#FFF",maxWidth:"800px"}})})},et=class extends d.Control{constructor(t,s,e,i=!1){super(s);this.emitter=t,this.key=s,this.component=et.component;const r=e.data[s]||"<div>{{name}}</div>";e.data[s]=r,e.data.output=r,this.props={readonly:i,value:r,onChange:o=>{this.setValue(o),this.emitter.trigger("process")}}}setValue(t){this.props.value=t,this.putData(this.key,t),this.putData("output",t),this.update()}};let W=et;w(W,"component",({value:t,onChange:s})=>l("div",{ref:e=>e&&e.addEventListener("pointerdown",i=>i.stopPropagation()),children:l(At,{value:t,onChange:e=>s(e)})}));class Rt extends d.Component{constructor(t){super("Handlebars");w(this,"path",["New"]);this.socket=t}builder(t){const s=new d.Output("hbs","Handlebars",this.socket);return t.addControl(new W(this.editor,"hbs",t)).addOutput(s)}worker(t,s,e){e.hbs=t.data.hbs}}const qt=window.pug,Vt=({value:C,onChange:t})=>{const[s,e]=j.exports.useState(C),[i,r]=j.exports.useState(!1),[o,n]=j.exports.useState(null);return V(()=>{o!==null&&(E(()=>import("./vendor.b0d57cfc.js").then(function(a){return a.q}),[]).then(({toast:a})=>a.error(o)),n(null))},1e4),l("div",{className:"hasScrollbar",style:{overflowY:"auto",maxHeight:"500px"},children:l(K,{textareaClassName:"editorTextarea",preClassName:"line-numbers",value:s,onValueChange:a=>{try{qt.compile(a),r(!1),n(null)}catch(c){n(c.message),r(!0)}e(a),t(a)},highlight:a=>P.exports.highlight(a,P.exports.languages.pug).split(`
`).map(c=>`<span class="container_editor_line_number">${c}</span>`).join(`
`),padding:10,style:{fontFamily:'"Fira code", "Fira Mono", monospace',fontSize:12,background:i?"rgba(255, 0, 80, 0.7)":"#FFF",maxWidth:"800px"}})})},st=class extends d.Control{constructor(t,s,e,i=!1){super(s);this.emitter=t,this.key=s,this.component=st.component;const r=e.data[s]||"div #{name}";e.data[s]=r,e.data.output=r,this.props={readonly:i,value:r,onChange:o=>{this.setValue(o),this.emitter.trigger("process")}}}setValue(t){this.props.value=t,this.putData(this.key,t),this.putData("output",t),this.update()}};let Q=st;w(Q,"component",({value:t,onChange:s})=>l("div",{ref:e=>e&&e.addEventListener("pointerdown",i=>i.stopPropagation()),children:l(Vt,{value:t,onChange:e=>s(e)})}));class Kt extends d.Component{constructor(t){super("Pug");w(this,"path",["New"]);this.socket=t}builder(t){const s=new d.Output("pug","Pug",this.socket);return t.addControl(new Q(this.editor,"pug",t)).addOutput(s)}worker(t,s,e){e.pug=t.data.pug}}class Bt extends J{render(){const{bindSocket:t,bindControl:s}=this.props,{outputs:e,controls:i,inputs:r,selected:o}=this.state;return m("div",{className:`node ${o}`,style:{background:"grey"},children:[l("div",{className:"title",children:"Endpoint"}),e.map(n=>m("div",{className:"output",children:[l("div",{className:"output-title",children:n.name}),l(F,{type:"output",socket:n.socket,io:n,innerRef:t})]},n.key)),i.map(n=>l(D,{className:"control",control:n,innerRef:s},n.key)),r.map(n=>m("div",{className:"input",children:[l(F,{type:"input",socket:n.socket,io:n,innerRef:t}),l("div",{className:"input-title",children:n.name})]},n.key))]})}}const nt=class extends d.Control{constructor(t,s,e,i=!1){super(s);this.emitter=t,this.component=nt.component,this.props={readonly:i,value:"",contentType:"",onChange:()=>{}},e.data.output=""}setValue(t,s,e,i,r){this.props.value=s,this.props.contentType=e,this.putData("enabledFlag",i),this.putData("output",s),this.putData("contentType",e),this.putData("path",r),Object.entries(t).forEach(([o,n])=>{n[0]&&this.putData(o,n[0])}),this.update()}};let z=nt;w(z,"component",({value:t,contentType:s,onChange:e})=>m(L,{children:[l("label",{style:{color:"white",display:"block",textAlign:"left"},children:"Preview"}),s==="text/html; charset=utf-8"?l("div",{className:"hasScrollbar",style:{backgroundColor:"white",overflowY:"auto",maxHeight:"500px"},dangerouslySetInnerHTML:{__html:t}}):l("textarea",{value:t,rows:10,ref:i=>i&&i.addEventListener("pointerdown",r=>r.stopPropagation()),onChange:i=>e(String(i.target.value)),disabled:!0})]}));const at=class extends d.Control{constructor(t,s,e,i=!1,r=""){super(s);this.emitter=t,this.key=s,this.component=at.component;const o=e.data[s]||!1;e.data[s]=o,e.data.output=o,this.props={readonly:i,checked:o,title:r,onChange:n=>{this.setValue(!!n),this.emitter.trigger("process")}}}setValue(t){this.props.checked=t,this.putData(this.key,t),this.putData("output",t),this.update()}};let T=at;w(T,"component",({checked:t,onChange:s,title:e,id:i=new Date().getTime()})=>m(L,{children:[e&&l("div",{style:{color:"white",textAlign:"left",marginBottom:"5px"},children:e}),m("div",{className:"switchArea",children:[l("input",{type:"checkbox",id:i,checked:t,ref:r=>r&&r.addEventListener("pointerdown",o=>o.stopPropagation()),onChange:r=>s(+r.target.checked)}),l("label",{htmlFor:i,children:l("span",{})}),l("div",{className:"swImg"})]})]}));const ot=class extends d.Control{constructor(t,s,e,i=!1,r="",o=""){super(s);this.emitter=t,this.key=s,this.component=ot.component;const n=e.data[s]||"";e.data[s]=n,e.data.output=n,this.props={readonly:i,value:n,title:r,placeHolder:o,onChange:a=>{this.setValue(a),this.emitter.trigger("process")}}}setValue(t){this.props.value=t,this.putData(this.key,t),this.putData("output",t),this.update()}};let O=ot;w(O,"component",({value:t,onChange:s,title:e,placeHolder:i})=>m(L,{children:[e&&l("label",{style:{color:"white",display:"block",textAlign:"left"},children:e}),l("input",{type:"text",value:t,placeholder:i,ref:r=>r&&r.addEventListener("pointerdown",o=>o.stopPropagation()),onChange:r=>s(String(r.target.value))})]}));const rt=class extends d.Control{constructor(t,s,e,i=!1,r="",o="",n=!1){super(s);this.emitter=t,this.key=s,this.component=rt.component;const a=e.data[s]||"/foo";e.data[s]=a,e.data.output=a,this.props={readonly:i,value:a,title:r,placeHolder:o,warn:n,onChange:c=>{c===""?this.props.warn=!0:c==="/metrics"||c==="/health"?(this.props.warn=!0,E(()=>import("./vendor.b0d57cfc.js").then(function(N){return N.q}),[]).then(({toast:N})=>N.error("this Path is reserved, use another Path."))):this.props.warn=!1,this.setValue(c),this.emitter.trigger("process")}}}setValue(t){this.props.value=t,this.putData(this.key,t),this.putData("output",t),this.update()}};let q=rt;w(q,"component",({value:t,onChange:s,title:e,placeHolder:i,warn:r})=>m(L,{children:[e&&l("label",{style:{color:"white",display:"block",textAlign:"left"},children:e}),l("input",{type:"text",value:t,placeholder:i,ref:o=>o&&o.addEventListener("pointerdown",n=>n.stopPropagation()),onChange:o=>s(String(o.target.value)),style:{background:r?"rgba(255, 0, 80, 0.7)":"#FFF"}})]}));const it=class extends d.Control{constructor(t,s,e,i=!1,r="",o=0,n=!1,a=!1){super(s);this.emitter=t,this.key=s,this.component=it.component;const c=e.data[s]||o;e.data[s]=c,e.data.output=c,this.props={readonly:i,value:c,title:r,disabled:n,hidden:a,onChange:N=>{this.setValue(N),this.emitter.trigger("process")}}}setValue(t,s=!1,e=!1){this.props.value=t,this.props.disabled=s,this.props.hidden=e,this.putData(this.key,t),this.putData("output",t),this.update()}};let _=it;w(_,"component",({value:t,onChange:s,title:e,disabled:i,hidden:r})=>m("div",{style:{display:r?"none":"block"},children:[e&&l("label",{style:{color:"white",display:"block",textAlign:"left"},children:e}),l("input",{type:"number",value:t,ref:o=>o&&o.addEventListener("pointerdown",n=>n.stopPropagation()),onChange:o=>s(+o.target.value),disabled:i})]}));const lt=class extends d.Control{constructor(t,s,e,i=!1,r="",o=[],n=!1,a=!1){super(s);this.emitter=t,this.key=s,this.component=lt.component;const c=e.data[s]||o[0];e.data[s]=c,e.data.output=c,this.props={readonly:i,value:c,title:r,values:o,disabled:n,hidden:a,onChange:N=>{this.setValue(N),this.emitter.trigger("process")}}}setValue(t,s=!1,e=!1){this.props.value=t,this.props.disabled=s,this.props.hidden=e,this.putData(this.key,t),this.putData("output",t),this.update()}};let $=lt;w($,"component",({title:t,value:s,values:e,onChange:i,disabled:r,hidden:o})=>m("div",{style:{display:o?"none":"block"},children:[t&&l("label",{style:{color:"white",display:"block",textAlign:"left"},children:t}),l("select",{style:{width:"100%"},value:s,ref:n=>n&&n.addEventListener("pointerdown",a=>a.stopPropagation()),onChange:n=>i(String(n.target.value)),disabled:r,children:e.map((n,a)=>l("option",{value:n,children:n},`${n}_${a}`))})]}));class Ht extends d.Component{constructor(t){super("Endpoint");w(this,"path",["New"]);this.data.component=Bt,this.stringSocket=t}builder(t){var e;t.data.enabledFlag=(e=t.data.enabledFlag)!=null?e:!0;const s=new d.Input("content","Content (JSON/HTML)",this.stringSocket);return s.addControl(new O(this.editor,"content",t)),t.addInput(s).addControl(new z(this.editor,"endpoint",t,!0)).addControl(new T(this.editor,"enabledFlag",t,!1,"Enabled")).addControl(new $(this.editor,"method",t,!1,"Method",["GET","POST","PUT","PATCH","DELETE","OPTIONS"])).addControl(new q(this.editor,"path",t,!1,"Path","/foo")).addControl(new T(this.editor,"botblockerEnableFlag",t,!1,"BotBlocker")).addControl(new T(this.editor,"ratelimitEnableFlag",t,!1,"RateLimit")).addControl(new $(this.editor,"ratelimitUnit",t,!1,"Unit",["any","ip"])).addControl(new _(this.editor,"ratelimitLimit",t,!1,"Limit",30)).addControl(new _(this.editor,"ratelimitBurst",t,!1,"Burst",0)).addControl(new _(this.editor,"ratelimitExpireSecond",t,!1,"ExpireSecond",60))}worker(t,s){const e=s.content.length?s.content[0]:"Rendering...",i=(n=>{if(n){if(n.output==="html")return"text/html; charset=utf-8";if(n.output==="json")return"application/json; charset=utf-8"}return"text/plain; charset=utf-8"})(t.inputs.content.connections[0]),{enabledFlag:r}=t.data,{path:o}=t.data;this.editor.nodes.find(n=>n.id===t.id).controls.get("endpoint").setValue(s,e,i,r,o),["ratelimitUnit","ratelimitLimit","ratelimitBurst","ratelimitExpireSecond"].forEach(n=>{this.editor.nodes.find(a=>a.id===t.id).controls.get(n).setValue(t.data[n],!t.data.ratelimitEnableFlag,!t.data.ratelimitEnableFlag)})}}class Ut extends J{render(){const{bindSocket:t,bindControl:s}=this.props,{outputs:e,controls:i,inputs:r,selected:o}=this.state;return m("div",{className:`node ${o}`,style:{background:"grey"},children:[l("div",{className:"title",children:"JSONManager"}),e.map(n=>m("div",{className:"output",children:[l("div",{className:"output-title",children:n.name}),l(F,{type:"output",socket:n.socket,io:n,innerRef:t})]},n.key)),i.map(n=>l(D,{className:"control",control:n,innerRef:s},n.key)),r.map(n=>m("div",{className:"input jsonManagerInput",children:[l(F,{type:"input",socket:n.socket,io:n,innerRef:t}),l("div",{className:"input-title",children:n.name})]},n.key))]})}}const ct=class extends d.Control{constructor(t,s,e,i=!1){super(s);this.emitter=t,this.component=ct.component,this.props={readonly:i,inputs:[],inputIds:[],outputs:e.data.output?JSON.parse(e.data.output):[],state:{pointerPos:{x:0,y:0},drag:{},selectedElement:{}},isDroppable:!1,onPointerOver:()=>{this.props.isDroppable=!0},onPointerOut:()=>{this.props.isDroppable=!1},onPointerDown:r=>{const o=r.currentTarget;this.props.state.pointerPos.x=r.clientX,this.props.state.pointerPos.y=r.clientY,this.props.state.selectedElement=o;const n=o.cloneNode(!0),a=n.style;a.transition="",a.pointerEvents="none",a.display="none",a.position="absolute";const c=10,N=/^.*scale\((.*)\)$/,g=document.getElementsByClassName("minimap")[0].previousElementSibling.style.transform.match(N)[1],v=(o.getBoundingClientRect().left-o.closest(".jsonManagerCtrl").getBoundingClientRect().left)/g+c;a.left=`${v}px`,o.after(n);const{left:b,top:p}=o.getBoundingClientRect(),h={x:b,y:p};this.props.state.drag={dragElement:n,position:h},o.classList.remove("jsonManagerCtrlInputKeyHover");const I=o.closest(".node");I.style.cursor="grabbing",I.addEventListener("pointerup",this.props.onPointerUp),I.addEventListener("pointermove",this.props.onPointerMove)},onPointerMove:r=>{r.stopPropagation();const o=/^.*scale\((.*)\)$/,a=document.getElementsByClassName("minimap")[0].previousElementSibling.style.transform.match(o)[1],{clientX:c,clientY:N}=r,{drag:u,pointerPos:g}=this.props.state,v=(c-g.x)/a,b=(N-g.y)/a,p=u.dragElement.style;p.display="inline-block",p.zIndex="100",p.transform=`translate(${v}px,${b}px)`},onPointerUp:()=>{const{drag:r,selectedElement:o}=this.props.state;this.props.state.drag=null,o.classList.add("jsonManagerCtrlInputKeyHover");const n=o.closest(".node");if(n.style.cursor="pointer",n.removeEventListener("pointerup",this.props.onPointerUp),n.removeEventListener("pointermove",this.props.onPointerMove),this.props.isDroppable){const a=parseInt(o.dataset.idx,10),c=parseInt(o.dataset.nodeid,10),N=o.innerText;if(o.dataset.type!=="func")this.props.outputs.filter(u=>u.key===N).length===1?this.props.outputs=this.props.outputs.map(u=>u.key===N?{srcId:c,srcIds:"",src:a,key:u.key,value:JSON.stringify(JSON.parse(this.props.inputs[a])[u.key])}:u):this.props.outputs.push({srcId:c,srcIds:"",src:a,key:N,value:JSON.stringify(JSON.parse(this.props.inputs[a])[N])});else{const{params:u}=this.props.outputFunctions[a],g=this.props.functions.filter(k=>k.name===this.props.outputFunctions[a].func)[0],{paramCount:v,logic:b}=g,{p0:p,p0Id:h}=(()=>{if(u[0].startsWith("inputs[")){const x=/^inputs\[(\d+)\](([^.]?)|\.(.*))$/.exec(u[0]),M=x[1],A=x[4];return A?{p0:JSON.parse(this.props.inputs[M])[A],p0Id:M}:{p0:JSON.parse(this.props.inputs[M]),p0Id:M}}return{p0:u[0],p0Id:null}})(),{p1:I,p1Id:y}=(()=>{if(v===2&&u[1].startsWith("inputs[")){const x=/^inputs\[(\d+)\](([^.]?)|\.(.*))$/.exec(u[1]),M=x[1],A=x[4];return A?{p1:JSON.parse(this.props.inputs[M])[A],p1Id:M}:{p1:JSON.parse(this.props.inputs[M]),p1Id:M}}return{p1:u[1],p1Id:null}})(),f=v===1?b(p):b(p,I),S=(()=>v===1?h!==null?`${h}:${parseInt(document.querySelectorAll(`.jsonManagerCtrlInputKey[data-idx='${h}']`)[0].dataset.nodeid,10)}`:"":h==null&&y==null?"":h==null?`${y}:${parseInt(document.querySelectorAll(`.jsonManagerCtrlInputKey[data-idx='${y}']`)[0].dataset.nodeid,10)}`:`${h}:${parseInt(document.querySelectorAll(`.jsonManagerCtrlInputKey[data-idx='${h}']`)[0].dataset.nodeid,10)}`)();this.props.outputs.filter(k=>k.key===N).length===1?this.props.outputs=this.props.outputs.map(k=>k.key===N?{srcId:-1,srcIds:S,src:(a+1)*-1,key:k.key,value:JSON.stringify(f)}:k):this.props.outputs.push({srcId:-1,srcIds:S,src:(a+1)*-1,key:N,value:JSON.stringify(f)})}this.putData("output",JSON.stringify(this.props.outputs)),this.update(),this.emitter.trigger("process")}r.dragElement.remove()},onClickCloseBtn:r=>{const o=r.currentTarget;this.props.outputs=this.props.outputs.reduce((n,a)=>a.key===o.dataset.key?n:[...n,a],[]),this.putData("output",JSON.stringify(this.props.outputs)),this.update(),this.emitter.trigger("process")},isModalOpen:!1,setModalOpen:r=>{this.props.isModalOpen=r,this.update(),this.emitter.trigger("process")},outputFunctions:!(Array.isArray(e.data.outputFunctions)&&e.data.outputFunctions.length===0)&&e.data.outputFunctions?JSON.parse(e.data.outputFunctions):[],functions:[{name:"Naming",paramCount:1,symbol:null,logic:r=>r}],onClickAddBtn:r=>{const o=r.currentTarget.previousElementSibling.value;o!==""&&(this.props.outputFunctions.push({func:o,name:"",params:[],warn:!1}),this.putData("outputFunctions",JSON.stringify(this.props.outputFunctions)),this.update(),this.emitter.trigger("process"))},onClickRemoveBtn:r=>{const o=parseInt(r.currentTarget.dataset.idx,10),{name:n}=this.props.outputFunctions[o];this.props.outputs=this.props.outputs.filter(a=>a.key!==n),this.props.outputFunctions=this.props.outputFunctions.filter((a,c)=>c!==o),this.putData("outputFunctions",JSON.stringify(this.props.outputFunctions)),this.update(),this.emitter.trigger("process")},onChangeModalFunc:r=>{const o=parseInt(r.currentTarget.dataset.idx,10);this.props.outputFunctions.filter(n=>n.name===r.target.value).length===1?this.props.outputFunctions[o].warn=!0:this.props.outputFunctions[o].warn=!1,this.props.outputFunctions[o].name=r.target.value,this.putData("outputFunctions",JSON.stringify(this.props.outputFunctions)),this.update(),this.emitter.trigger("process")},onChangeModalFuncParams:r=>{const o=parseInt(r.currentTarget.dataset.idx,10),n=parseInt(r.currentTarget.dataset.paramsIdx,10);if(n===2&&this.props.outputFunctions[o].params.length<2&&(this.props.outputFunctions[o].params[0]=null),this.props.outputFunctions[o].params[n]=r.target.value,this.putData("outputFunctions",JSON.stringify(this.props.outputFunctions)),this.props.outputFunctions[o].name){const a=this.props.outputFunctions[o].name,{params:c}=this.props.outputFunctions[o],N=this.props.functions.filter(v=>v.name===this.props.outputFunctions[o].func)[0],{paramCount:u,logic:g}=N;if(u===1||c[0]){const{p0:v,p0Id:b}=(()=>{if(c[0].startsWith("inputs[")){const S=/^inputs\[(\d+)\](([^.]?)|\.(.*))$/.exec(c[0]),k=S[1],x=S[4];return x?{p0:JSON.parse(this.props.inputs[k])[x],p0Id:k}:{p0:JSON.parse(this.props.inputs[k]),p0Id:k}}return{p0:c[0],p0Id:null}})(),{p1:p,p1Id:h}=(()=>{if(u===2&&c[1].startsWith("inputs[")){const S=/^inputs\[(\d+)\](([^.]?)|\.(.*))$/.exec(c[1]),k=S[1],x=S[4];return x?{p1:JSON.parse(this.props.inputs[k])[x],p1Id:k}:{p1:JSON.parse(this.props.inputs[k]),p1Id:k}}return{p1:c[1],p1Id:null}})(),I=u===1?g(v):g(v,p),y=(()=>u===1?b!==null?`${b}:${parseInt(document.querySelectorAll(`.jsonManagerCtrlInputKey[data-idx='${b}']`)[0].dataset.nodeid,10)}`:"":b==null&&h==null?"":b==null?`${h}:${parseInt(document.querySelectorAll(`.jsonManagerCtrlInputKey[data-idx='${h}']`)[0].dataset.nodeid,10)}`:`${b}:${parseInt(document.querySelectorAll(`.jsonManagerCtrlInputKey[data-idx='${b}']`)[0].dataset.nodeid,10)}`)();this.props.outputs.filter(f=>f.key===a).length===1&&(this.props.outputs=this.props.outputs.map(f=>f.key===a?{srcId:-1,srcIds:y,src:(o+1)*-1,key:f.key,value:JSON.stringify(I)}:f))}}this.update(),this.emitter.trigger("process")},textAreaRef:pt.createRef(),previewRef:pt.createRef()}}setValue(t,s){const e=t.inputs.content.connections.map(r=>r.node),{content:i}=s;this.props.inputs=i,this.props.inputIds=e,i.length===0&&(this.props.outputs=[],this.props.outputFunctions=[]),e.length>i.length?(this.props.outputs=[],this.props.outputFunctions=[]):(i.forEach((o,n)=>this.props.outputs=this.props.outputs.reduce((a,c)=>{if(c.src===n){const N=JSON.parse(o);return Object.keys(N).includes(c.key)?[...a,{srcId:c.srcId,srcIds:c.srcIds,src:c.src,key:c.key,value:JSON.stringify(N[c.key])}]:a}return[...a,c]},[])),this.props.outputFunctions.filter(o=>o.name&&o.params.reduce((n,a)=>n||a.startsWith("inputs["),!1)).length&&(this.props.outputFunctions.forEach((o,n)=>{try{const a=o.name,{params:c}=o,N=this.props.functions.filter(v=>v.name===o.func)[0],{paramCount:u,logic:g}=N;if(u===1||c[0]){const v=(()=>{if(c[0]!==void 0&&c[0].startsWith("inputs[")){const I=/^inputs\[(\d+)\](([^.]?)|\.(.*))$/.exec(c[0]),y=I[1],f=I[4],S=f?JSON.parse(this.props.inputs[y])[f]:JSON.parse(this.props.inputs[y]);if(S===void 0)throw Error;return S}return c[0]})(),b=(()=>{if(u===2&&c[1]!==void 0&&c[1].startsWith("inputs[")){const I=/^inputs\[(\d+)\](([^.]?)|\.(.*))$/.exec(c[1]),y=I[1],f=I[4],S=f?JSON.parse(this.props.inputs[y])[f]:JSON.parse(this.props.inputs[y]);if(S===void 0)throw Error;return S}return c[1]})(),p=u===1?g(v):g(v,b);this.props.outputs.filter(h=>h.key===a).length===1&&(this.props.outputs=this.props.outputs.map(h=>h.key===a?{srcId:h.srcId,srcIds:h.srcIds,src:h.src,key:h.key,value:JSON.stringify(p)}:h))}}catch{this.props.outputs=this.props.outputs.filter(c=>c.key!==this.props.outputFunctions[n].name),delete this.props.outputFunctions[n]}}),this.props.outputFunctions=this.props.outputFunctions.filter(o=>o!==void 0))),this.putData("output",JSON.stringify(this.props.outputs)),this.update()}};let Y=ct;w(Y,"component",({inputs:t,inputIds:s,outputs:e,onPointerDown:i,onPointerOver:r,onPointerOut:o,onClickCloseBtn:n,isModalOpen:a,setModalOpen:c,functions:N,onClickAddBtn:u,onChangeModalFunc:g,outputFunctions:v,onClickRemoveBtn:b,onChangeModalFuncParams:p,textAreaRef:h,previewRef:I})=>m("div",{className:"jsonManagerCtrl",children:[m(dt,{isOpen:a,style:{content:{padding:"0px"}},children:[m("div",{className:"jsonManagerModalTitle",children:[l("p",{style:{display:"inline-block",fontWeight:"600",fontSize:"18px"},children:"Functions"}),l("span",{role:"button",tabIndex:"0",className:"closeBtn",onClick:()=>c(!1)})]}),m("div",{className:"jsonManagerModalContent",children:[m("select",{style:{color:"#767676"},ref:y=>y&&y.addEventListener("pointerdown",f=>f.stopPropagation()),children:[l("option",{value:"",style:{display:"none"},children:"Select your function"}),N.map(y=>l("option",{value:y.name,children:y.name},y.name))]}),l("div",{role:"button",tabIndex:"0",className:"modalAddBtn",onClick:u,children:"Add"}),v.map((y,f)=>m("div",{className:"modalFunction",children:[m("p",{className:"modalFunctionTitle",children:[y.func,l("span",{role:"button",tabIndex:"0",className:"removeBtn",onClick:b,"data-idx":f})]}),m("div",{className:"modalFunctionKey",children:[l("p",{className:"modalFunctionKeyTitle",children:"name:"}),l("input",{type:"text",value:y.name,placeholder:"name to use output",ref:S=>{S&&S.addEventListener("pointerdown",k=>k.stopPropagation())},onChange:g,"data-idx":f,style:{background:y.warn?"rgba(255, 0, 80, 0.7)":"#FFF"}})]}),m("div",{className:"modalFunctionKey",children:[l("p",{className:"modalFunctionKeyTitle",children:"params: "}),l("div",{className:"modalFunctionContent",children:(()=>{const S=N.filter(k=>k.name===y.func)[0];return S.paramCount===1?l("input",{className:"modalFunctionContentInput",list:"inputs-datalist",name:`func-${f}_0`,placeholder:"Input or Select your param",onChange:p,"data-idx":f,"data-params-idx":0,value:y.params[0]?y.params[0]:""}):m(L,{children:[l("input",{className:"modalFunctionContentInput",list:"inputs-datalist",name:`func-${f}_0`,placeholder:"Input or Select your param",onChange:p,"data-idx":f,"data-params-idx":0,value:y.params[0]?y.params[0]:null}),l("span",{className:"modalFunctionContentSymbol",children:S.symbol}),l("input",{className:"modalFunctionContentInput",list:"inputs-datalist",name:`func-${f}_1`,placeholder:"Input or Select your param",onChange:p,"data-idx":f,"data-params-idx":1,value:y.params[1]?y.params[1]:null})]})})()})]})]},`modalFunction_${f}`)),l("datalist",{id:"inputs-datalist",children:t.map((y,f)=>{try{const S=JSON.parse(y);return(()=>[...Array.isArray(S)?[l("option",{value:`inputs[${f}]`,children:`inputs[${f}]`},`inputs[${f}]`)]:[],...Object.keys(S).map(x=>l("option",{value:`inputs[${f}].${x}`,children:`inputs[${f}].${x}`},`inputs[${f}].${x}`))])()}catch{return""}})})]})]}),m("div",{className:"jsonManagerCtrlInputs",children:[m("div",{className:"jsonManagerCtrlInput",children:[l("p",{className:"jsonManagerCtrlCategory",children:"Inputs"}),t.map((y,f)=>{try{const S=JSON.parse(y);return Array.isArray(S)?m("div",{className:"jsonManagerCtrlInputGroup",children:[m("p",{className:"jsonManagerCtrlInputTitle",children:["inputs[",f,"]"]}),l("p",{className:"jsonManagerCtrlInputKey","data-nodeid":s[f],children:"Array"})]},`jsonManagerCtrlInputGroup_${f}`):m("div",{className:"jsonManagerCtrlInputGroup",children:[m("p",{className:"jsonManagerCtrlInputTitle",children:["inputs[",f,"]"]}),Object.keys(S).map((k,x)=>l("p",{className:"jsonManagerCtrlInputKey jsonManagerCtrlInputKeyHover",onPointerDown:i,"data-idx":f,"data-nodeid":s[f],children:k},`jsonManagerCtrlInputKey_${x}`))]},`jsonManagerCtrlInputGroup_${f}`)}catch{return""}})]}),m("div",{className:"jsonManagerCtrlFunctions",children:[m("p",{className:"jsonManagerCtrlCategory",children:["Functions",l("span",{role:"button",tabIndex:"0",className:"addBtn",onClick:()=>c(!0)})]}),l("div",{className:"jsonManagerCtrlInputGroup",children:v.map((y,f)=>y.name!==""&&m("p",{className:"jsonManagerCtrlInputKey jsonManagerCtrlInputKeyHover",onPointerDown:i,"data-idx":f,"data-type":"func",children:[y.name,l("span",{role:"button",tabIndex:"0",className:"removeBtn",onClick:b,"data-idx":f})]},`jsonManagerCtrlInputKey_${f}_func`))})]})]}),l("div",{className:"jsonManagerCtrlHint",children:">>>"}),m("div",{className:"jsonManagerCtrlOutputs",children:[m("div",{className:"jsonManagerCtrlPreview",style:{height:h&&I&&h.current&&I.current?`${h.current.scrollHeight+I.current.scrollHeight}px`:"initial",maxHeight:"200px"},children:[l("p",{className:"jsonManagerCtrlCategory",ref:I,children:"Preview"}),l("textarea",{disabled:!0,ref:h,className:"jsonManagerCtrlPreviewArea hasScrollbar",value:e.length!==0?JSON.stringify(Object.fromEntries(e.map(y=>[y.key,y.value?JSON.parse(y.value):""])),null,2):""})]}),m("div",{className:"jsonManagerCtrlOutput",onPointerOver:r,onPointerOut:o,children:[l("p",{className:"jsonManagerCtrlCategory",children:"Outputs"}),l("div",{className:"jsonManagerCtrlOutputArea",children:e.map((y,f)=>m("p",{className:"jsonManagerCtrlOutputKey",children:[y.key,l("span",{role:"button",tabIndex:"0",className:"removeBtn",onClick:n,"data-key":y.key})]},`jsonManagerCtrlOutputKey_${f}`))})]})]})]}));class Wt extends d.Component{constructor(t){super("JSONManager");w(this,"path",["New"]);this.data.component=Ut,this.jsonSocket=t}builder(t){const s=new d.Input("content","JSONs",this.jsonSocket,!0),e=new d.Output("json","JSON",this.jsonSocket);return t.addInput(s).addControl(new Y(this.editor,"jsonManager",t,!0)).addOutput(e)}worker(t,s,e){if(this.editor.nodes.find(i=>i.id===t.id).controls.get("jsonManager").setValue(t,s),t.data.output==="[]")e.json="";else if(t.data.output!==""){const i=JSON.parse(t.data.output).map(r=>[r.key,JSON.parse(r.value)]);e.json=JSON.stringify(Object.fromEntries(i))}e.outputFunctions=t.data.outputFunctions}}class G extends J{render(){const{node:t,bindSocket:s,bindControl:e}=this.props,{outputs:i,controls:r,inputs:o,selected:n}=this.state;return m("div",{className:`node ${n}`,style:{background:"grey"},children:[l("div",{className:"title",children:t.name}),i.map(a=>m("div",{className:"output",children:[l("div",{className:"output-title",children:a.name}),l(F,{type:"output",socket:a.socket,io:a,innerRef:s})]},a.key)),r.map(a=>l(D,{className:"control",control:a,innerRef:e},a.key)),o.map(a=>m("div",{className:"input",children:[l(F,{type:"input",socket:a.socket,io:a,innerRef:s}),!a.showControl()&&l("div",{className:"input-title",children:a.name}),a.showControl()&&l(D,{className:"input-control",control:a.control,innerRef:e})]},a.key))]})}}class Qt extends d.Component{constructor(t){super("API");w(this,"path",["New"]);this.data.component=G,this.jsonSocket=t}builder(t){const s=new d.Input("json","Dummy Output (JSON)",this.jsonSocket),e=new d.Output("json","JSON",this.jsonSocket);return t.addInput(s).addControl(new $(this.editor,"method",t,!1,"Method",["GET","POST","PUT","PATCH","DELETE","OPTIONS"])).addControl(new O(this.editor,"url",t,!1,"URL","https://example.com/bar")).addControl(new T(this.editor,"cached",t,!1,"Cached (In-Memory)")).addControl(new _(this.editor,"cacheTime",t,!1,"CacheTime (seconds)",30)).addOutput(e)}worker(t,s,e){e.json=s.json.length?s.json[0]:t.data.json,e.url=t.data.url,e.cached=t.data.cached,this.editor.nodes.find(i=>i.id===t.id).controls.get("cacheTime").setValue(t.data.cacheTime,!t.data.cached,!t.data.cached)}}class ht extends J{render(){const{node:t,bindSocket:s,bindControl:e}=this.props,{outputs:i,controls:r,inputs:o,selected:n}=this.state,a=r.filter(u=>u.key==="db").map(u=>u.props.value===""?"DB":u.props.value.toUpperCase())[0],c=r.filter(u=>u.key==="user").map(u=>u.props.value===""?"USER":u.props.value.toUpperCase())[0],N=`${a}_PASS_ON_${c}`;return m("div",{className:`node ${n}`,style:{background:"grey"},children:[l("div",{className:"title",children:t.name}),i.map(u=>m("div",{className:"output",children:[l("div",{className:"output-title",children:u.name}),l(F,{type:"output",socket:u.socket,io:u,innerRef:s})]},u.key)),r.map(u=>m(L,{children:[l(D,{className:"control",control:u,innerRef:e},u.key),u.key==="db"&&m("div",{className:"control",title:"pass",children:[l("label",{style:{color:"white",display:"block",textAlign:"left"},children:"DB_PASS"}),l("textarea",{rows:"3",placeholder:`set ${N} when tuna api starting`,value:"",disabled:!0})]})]})),o.map(u=>m("div",{className:"input",children:[l(F,{type:"input",socket:u.socket,io:u,innerRef:s}),!u.showControl()&&l("div",{className:"input-title",children:u.name}),u.showControl()&&l(D,{className:"input-control",control:u.control,innerRef:e})]},u.key))]})}}class zt extends d.Component{constructor(t,s){super("MySQL");w(this,"path",["New"]);this.data.component=ht,this.jsonSocket=t,this.sqlSocket=s}builder(t){const s=new d.Input("json","Dummy Output (JSON)",this.jsonSocket),e=new d.Output("json","JSON",this.jsonSocket),i=new d.Input("sql","SQL",this.sqlSocket);return t.addInput(i).addInput(s).addControl(new $(this.editor,"tls",t,!1,"TLS",["false","true","skip-verify","preferred"])).addControl(new O(this.editor,"host",t,!1,"HOST","127.0.0.1")).addControl(new O(this.editor,"port",t,!1,"PORT","3306")).addControl(new O(this.editor,"user",t,!1,"USER","guest")).addControl(new O(this.editor,"db",t,!1,"DB_NAME","foo")).addControl(new T(this.editor,"cached",t,!1,"Cached (In-Memory)")).addControl(new _(this.editor,"cacheTime",t,!1,"CacheTime (seconds)",30)).addOutput(e)}worker(t,s,e){e.json=s.json.length?s.json[0]:t.data.json,e.sql=s.sql.length?s.sql[0]:t.data.sql,e.tls=t.data.tls,e.host=t.data.host,e.port=t.data.port,e.user=t.data.user,e.db=t.data.db,e.cached=t.data.cached,e.cacheTime=t.data.cacheTime,this.editor.nodes.find(i=>i.id===t.id).controls.get("cacheTime").setValue(t.data.cacheTime,!t.data.cached,!t.data.cached)}}class Yt extends d.Component{constructor(t,s){super("PostgreSQL");w(this,"path",["New"]);this.data.component=ht,this.jsonSocket=t,this.sqlSocket=s}builder(t){const s=new d.Input("json","Dummy Output (JSON)",this.jsonSocket),e=new d.Output("json","JSON",this.jsonSocket),i=new d.Input("sql","SQL",this.sqlSocket);return t.addInput(i).addInput(s).addControl(new $(this.editor,"tls",t,!1,"SSLMODE",["disable","require","verify-ca","verify-full"])).addControl(new O(this.editor,"host",t,!1,"HOST","127.0.0.1")).addControl(new O(this.editor,"port",t,!1,"PORT","5432")).addControl(new O(this.editor,"user",t,!1,"USER","guest")).addControl(new O(this.editor,"db",t,!1,"DB_NAME","foo")).addControl(new T(this.editor,"cached",t,!1,"Cached (In-Memory)")).addControl(new _(this.editor,"cacheTime",t,!1,"CacheTime (seconds)",30)).addOutput(e)}worker(t,s,e){e.json=s.json.length?s.json[0]:t.data.json,e.sql=s.sql.length?s.sql[0]:t.data.sql,e.sslmode=t.data.sslmode,e.host=t.data.host,e.port=t.data.port,e.user=t.data.user,e.db=t.data.db,e.cached=t.data.cached,e.cacheTime=t.data.cacheTime,this.editor.nodes.find(i=>i.id===t.id).controls.get("cacheTime").setValue(t.data.cacheTime,!t.data.cached,!t.data.cached)}}class Gt extends J{render(){const{node:t,bindSocket:s,bindControl:e}=this.props,{outputs:i,controls:r,inputs:o,selected:n}=this.state;return m("div",{className:`node ${n}`,style:{background:"grey"},children:[l("div",{className:"title",children:t.name}),i.map(a=>m("div",{className:"output",children:[l("div",{className:"output-title",children:a.name}),l(F,{type:"output",socket:a.socket,io:a,innerRef:s})]},a.key)),r.map(a=>l(D,{className:"control",control:a,innerRef:e},a.key)),o.map(a=>m("div",{className:"input",children:[l(F,{type:"input",socket:a.socket,io:a,innerRef:s}),!a.showControl()&&l("div",{className:"input-title",children:a.name}),a.showControl()&&l(D,{className:"input-control",control:a.control,innerRef:e})]},a.key))]})}}class Xt extends d.Component{constructor(t,s){super("SQLite");w(this,"path",["New"]);this.data.component=Gt,this.jsonSocket=t,this.sqlSocket=s}builder(t){const s=new d.Input("json","Dummy Output (JSON)",this.jsonSocket),e=new d.Output("json","JSON",this.jsonSocket),i=new d.Input("sql","SQL",this.sqlSocket);return t.addInput(i).addInput(s).addControl(new O(this.editor,"filename",t,!1,"FILE_NAME","test.db")).addControl(new T(this.editor,"cached",t,!1,"Cached (In-Memory)")).addControl(new _(this.editor,"cacheTime",t,!1,"CacheTime (seconds)",30)).addOutput(e)}worker(t,s,e){e.json=s.json.length?s.json[0]:t.data.json,e.sql=s.sql.length?s.sql[0]:t.data.sql,e.filename=t.data.filename,e.cached=t.data.cached,e.cacheTime=t.data.cacheTime,this.editor.nodes.find(i=>i.id===t.id).controls.get("cacheTime").setValue(t.data.cacheTime,!t.data.cached,!t.data.cached)}}class Zt extends d.Component{constructor(t){super("Request");w(this,"path",["New"]);this.data.component=G,this.jsonSocket=t}builder(t){const s=new d.Input("json","Dummy Output (JSON)",this.jsonSocket),e=new d.Output("json","JSON",this.jsonSocket);return t.addInput(s).addControl(new $(this.editor,"type",t,!1,"Type",["QUERY","COOKIE","BODY"])).addOutput(e)}worker(t,s,e){e.json=s.json.length?s.json[0]:t.data.json,e.type=t.data.type}}class te extends d.Component{constructor(){super("RedirectEndpoint");w(this,"path",["New"]);this.data.component=G}builder(t){var s;return t.data.enabledFlag=(s=t.data.enabledFlag)!=null?s:!0,t.addControl(new T(this.editor,"enabledFlag",t,!1,"Enabled")).addControl(new q(this.editor,"path",t,!1,"Path","/foo")).addControl(new O(this.editor,"url",t,!1,"Url","https://example.com"))}worker(t,s,e){e.enabledFlag=t.data.enabledFlag,e.path=t.data.path,e.url=t.data.url}}async function ee(C){const t=new d.Socket("String value"),s=new d.Socket("Json value");s.combineWith(t);const e=new d.Socket("Template value");e.combineWith(t);const i=new d.Socket("Handlebars value");i.combineWith(e);const r=new d.Socket("Pug value");r.combineWith(e);const o=new d.Socket("HTML value");o.combineWith(t);const n=new d.Socket("SQL value"),a=[new Ht(t),new Wt(s),new _t(s),new Jt(s,e,o),new Rt(i),new Kt(r),new Pt(n),new Qt(s),new zt(s,n),new Yt(s,n),new Xt(s,n),new Zt(s),new te],N=window.navigator.userAgent.toLowerCase().indexOf("mac os x")!==-1,u=()=>{const{nodeName:p}=document.activeElement;return p==="TEXTAREA"||p==="INPUT"},g=new d.NodeEditor("tuna-mayonnaise@0.0.1",C);g.use(Nt),g.use(St),g.use(kt,{searchBar:!1,delay:100,allocate(p){return p.path},rename(p){return p.name},items:{Arrange(){g.nodes.forEach(p=>{g.trigger("arrange",p)})},Undo(){g.trigger("undo")},Redo(){g.trigger("redo")},Save(){E(()=>import("./index.52d8ea3d.js").then(function(p){return p.i}),[]).then(p=>{p.post("/regist",g.toJSON()).then(()=>E(()=>import("./vendor.b0d57cfc.js").then(function(h){return h.q}),[]).then(({toast:h})=>h.success("SAVED :)"))).catch(()=>E(()=>import("./vendor.b0d57cfc.js").then(function(h){return h.q}),[]).then(({toast:h})=>h.error("NOT CONNECTED :(")))})},Download(){const p=new Blob([JSON.stringify(g.toJSON())],{type:"application/json; charset=utf-8"});E(()=>import("./FileSaver.min.e7521b04.js").then(function(h){return h.F}),["assets/FileSaver.min.e7521b04.js","assets/vendor.b0d57cfc.js"]).then(({saveAs:h})=>h(p,"tuna-mayonnaise.json"))},Debug(){console.log(JSON.stringify(g.toJSON()))}}}),g.on("zoom",({source:p})=>p!=="dblclick"&&p==="wheel"&&!u()),g.use(wt,{keyboard:!1}),g.on("keydown",p=>{if(!u()){switch(p.code){case"Delete":case"Backspace":g.selected.each(h=>{g.removeNode(h)}),g.selected.clear();return;case"Space":{const h=g.view.container.getBoundingClientRect(),I=new PointerEvent("contextmenu",{clientX:h.left+h.width/2,clientY:h.top+h.height/2});g.trigger("contextmenu",{e:I,view:g.view});return}}if(p.ctrlKey||N&&p.metaKey)switch(p.code){case"KeyY":g.trigger("redo");return;case"KeyZ":p.shiftKey?g.trigger("redo"):g.trigger("undo");break}}}),g.use(vt),g.use(B,{type:B.DEFAULT,transformer:()=>([p,h,I,y])=>[[p,h],[I,y]],curve:B.curveBundle,options:{vertical:!1,curvature:.4},arrow:{color:"steelblue",marker:"M-5,-10 L-5,10 L20,0 z"}}),g.use(bt),g.use(It,{margin:{x:200,y:50},depth:0});const v=new d.Engine("tuna-mayonnaise@0.0.1");a.forEach(p=>{g.register(p),v.register(p)});const b=await E(()=>import("./index.52d8ea3d.js").then(function(p){return p.i}),[]).then(p=>p.get("/tuna-configuration").then(h=>h.data).catch(()=>(document.getElementsByClassName("rightClick")[0].style.display="block",null)));if(b!==null)await g.fromJSON(b),E(()=>import("./vendor.b0d57cfc.js").then(function(p){return p.q}),[]).then(({toast:p})=>p.success("RESUMED :)"));else{const p=await a[0].createNode();p.position=[1e3,200],g.addNode(p)}g.on("showcontextmenu",()=>(document.getElementsByClassName("rightClick")[0].style.display="none",!0)),g.on("process nodecreated noderemoved connectioncreated connectionremoved",async()=>{document.querySelectorAll(".editorTextarea").forEach(p=>{p.addEventListener("wheel",h=>{u()&&(p.parentElement.parentElement.scrollTop+=h.deltaY)})}),await v.abort(),await v.process(g.toJSON())}),g.view.resize(),g.trigger("process"),xt.zoomAt(g,g.nodes)}const se=()=>m("div",{className:"App",children:[l(Et,{}),l("img",{className:"rightClick",src:"/right-click.svg",width:"200",height:"200",alt:"RightClick for Menu",style:{display:"none",position:"absolute",top:"25%",left:"25%",pointerEvents:"none"}}),l("div",{style:{width:"100vh",height:"100vh"},ref:C=>C&&ee(C)})]});dt.setAppElement("#root");const ne=document.getElementById("root");Ot.render(l(se,{}),ne);
