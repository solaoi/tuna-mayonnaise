var ft=Object.defineProperty;var yt=(C,t,s)=>t in C?ft(C,t,{enumerable:!0,configurable:!0,writable:!0,value:s}):C[t]=s;var S=(C,t,s)=>(yt(C,typeof t!="symbol"?t+"":t,s),s);import{r as j,u as H,j as l,_ as q,a as Ct,p as D,i as d,s as kt,N as J,b as h,S as O,C as L,F as _,H as wt,M as mt,R as ut,c as St,d as Nt,e as bt,f as vt,g as xt,k as W,l as It,A as Et,m as Ot,n as jt,T as Ft}from"./vendor.1ab47a0d.js";const Tt=function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))e(a);new MutationObserver(a=>{for(const o of a)if(o.type==="childList")for(const r of o.addedNodes)r.tagName==="LINK"&&r.rel==="modulepreload"&&e(r)}).observe(document,{childList:!0,subtree:!0});function s(a){const o={};return a.integrity&&(o.integrity=a.integrity),a.referrerpolicy&&(o.referrerPolicy=a.referrerpolicy),a.crossorigin==="use-credentials"?o.credentials="include":a.crossorigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function e(a){if(a.ep)return;a.ep=!0;const o=s(a);fetch(a.href,o)}};Tt();const Mt="modulepreload",ht={},Pt="./",P=function(t,s){return!s||s.length===0?t():Promise.all(s.map(e=>{if(e=`${Pt}${e}`,e in ht)return;ht[e]=!0;const a=e.endsWith(".css"),o=a?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${e}"]${o}`))return;const r=document.createElement("link");if(r.rel=a?"stylesheet":Mt,a||(r.as="script",r.crossOrigin=""),r.href=e,document.head.appendChild(r),a)return new Promise((n,i)=>{r.addEventListener("load",n),r.addEventListener("error",()=>i(new Error(`Unable to preload CSS for ${e}`)))})})).then(()=>t())};const Dt=({value:C,onChange:t})=>{const[s,e]=j.exports.useState(C),[a,o]=j.exports.useState(!1),[r,n]=j.exports.useState(null);return H(()=>{r!==null&&(P(()=>import("./vendor.1ab47a0d.js").then(function(i){return i.q}),[]).then(({toast:i})=>i.error(r)),n(null))},1e4),l(q,{value:s,onValueChange:i=>{try{Ct.exports.parse(i),o(!1),n(null)}catch(c){n(c.message),o(!0)}e(i),t(i)},highlight:i=>D.exports.highlight(i,D.exports.languages.json),padding:10,style:{fontFamily:'"Fira code", "Fira Mono", monospace',fontSize:12,background:a?"rgba(255, 0, 80, 0.7)":"#FFF",maxWidth:"300px"}})},Z=class extends d.Control{constructor(t,s,e,a=!1){super(s);this.emitter=t,this.key=s,this.component=Z.component;const o=e.data[s]||'{"name": "value"}';e.data[s]=o,e.data.output=o,this.props={readonly:a,value:o,onChange:r=>{this.setValue(r),this.emitter.trigger("process")}}}setValue(t){this.props.value=t,this.putData(this.key,t),this.putData("output",t),this.update()}};let V=Z;S(V,"component",({value:t,onChange:s})=>l("div",{ref:e=>e&&e.addEventListener("pointerdown",a=>a.stopPropagation()),children:l(Dt,{value:t,onChange:e=>s(e)})}));class Lt extends d.Component{constructor(t){super("JSON");S(this,"path",["New"]);this.socket=t}builder(t){const s=new d.Output("json","JSON",this.socket);return t.addControl(new V(this.editor,"json",t)).addOutput(s)}worker(t,s,e){e.json=t.data.json}}const $t=({value:C,onChange:t})=>{const[s,e]=j.exports.useState(C);return l("div",{className:"hasScrollbar",style:{overflowY:"auto",maxHeight:"500px"},children:l(q,{textareaClassName:"editorTextarea",preClassName:"line-numbers",value:s,onValueChange:a=>{e(a),t(a)},highlight:a=>D.exports.highlight(a,D.exports.languages.xml).split(`
`).map(o=>`<span class="container_editor_line_number">${o}</span>`).join(`
`),padding:10,style:{fontFamily:'"Fira code", "Fira Mono", monospace',fontSize:12,background:"#FFF",maxWidth:"800px"}})})},tt=class extends d.Control{constructor(t,s,e,a=!1){super(s);this.emitter=t,this.key=s,this.component=tt.component;const o=e.data[s]||`<!DOCTYPE html>
    <html lang="en">
      <head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <meta http-equiv="X-UA-Compatible" content="ie=edge">
        <title>REPLACE HERE!</title>
        <!-- <link rel="stylesheet" href="style.css"> -->
      </head>
      <body>
      <!-- <script src="index.js"><\/script> -->
      </body>
    </html>`;e.data[s]=o,e.data.output=o,this.props={readonly:a,value:o,onChange:r=>{this.setValue(r),this.emitter.trigger("process")}}}setValue(t){this.props.value=t,this.putData(this.key,t),this.putData("output",t),this.update()}};let K=tt;S(K,"component",({value:t,onChange:s})=>l("div",{ref:e=>e&&e.addEventListener("pointerdown",a=>a.stopPropagation()),children:l($t,{value:t,onChange:e=>s(e)})}));class Jt extends d.Component{constructor(t){super("HTML");S(this,"path",["New"]);this.socket=t}builder(t){const s=new d.Output("html","HTML",this.socket);return t.addControl(new K(this.editor,"html",t)).addOutput(s)}worker(t,s,e){e.html=t.data.html}}const _t=({value:C,onChange:t})=>{const[s,e]=j.exports.useState(C),[a,o]=j.exports.useState(!1),[r,n]=j.exports.useState(null);return H(()=>{r!==null&&(P(()=>import("./vendor.1ab47a0d.js").then(function(i){return i.q}),[]).then(({toast:i})=>i.error(r)),n(null))},1e4),l(q,{value:s,onValueChange:i=>{try{kt.exports.parse(i),o(!1),n(null)}catch(c){n(c.message),o(!0)}e(i),t(i)},highlight:i=>D.exports.highlight(i,D.exports.languages.sql),padding:10,style:{fontFamily:'"Fira code", "Fira Mono", monospace',fontSize:12,background:a?"rgba(255, 0, 80, 0.7)":"#FFF",maxWidth:"300px"}})},et=class extends d.Control{constructor(t,s,e,a=!1){super(s);this.emitter=t,this.key=s,this.component=et.component;const o=e.data[s]||"SELECT * FROM users";e.data[s]=o,e.data.output=o,this.props={readonly:a,value:o,onChange:r=>{this.setValue(r),this.emitter.trigger("process")}}}setValue(t){this.props.value=t,this.putData(this.key,t),this.putData("output",t),this.update()}};let U=et;S(U,"component",({value:t,onChange:s})=>l("div",{ref:e=>e&&e.addEventListener("pointerdown",a=>a.stopPropagation()),children:l(_t,{value:t,onChange:e=>s(e)})}));class At extends d.Component{constructor(t){super("SQL");S(this,"path",["New"]);this.socket=t}builder(t){const s=new d.Output("sql","SQL",this.socket);return t.addControl(new U(this.editor,"sql",t)).addOutput(s)}worker(t,s,e){e.sql=t.data.sql}}class Rt extends J{render(){const{bindSocket:t,bindControl:s}=this.props,{outputs:e,controls:a,inputs:o,selected:r}=this.state;return h("div",{className:`node ${r}`,style:{background:"grey"},children:[l("div",{className:"title",children:"Template"}),e.map(n=>h("div",{className:"output",children:[l("div",{className:"output-title",children:n.name}),l(O,{type:"output",socket:n.socket,io:n,innerRef:t})]},n.key)),a.map(n=>l(L,{className:"control",control:n,innerRef:s},n.key)),o.map(n=>h("div",{className:"input",children:[l(O,{type:"input",socket:n.socket,io:n,innerRef:t}),l("div",{className:"input-title",children:n.name})]},n.key))]})}}const st=class extends d.Control{constructor(t,s,e,a=!1){super(s);this.emitter=t,this.keys=[],this.component=st.component,this.props={readonly:a,value:"",onChange:()=>{}},e.data.output=""}setValue(t,s,e){this.props.value=s,this.putData("output",s),this.putData("contentType",e),Object.entries(t).forEach(([a,o])=>{o[0]&&this.putData(a,o[0])}),this.update()}};let Q=st;S(Q,"component",({value:t,onChange:s})=>h(_,{children:[l("label",{style:{color:"white",display:"block",textAlign:"left"},children:"Preview"}),l("textarea",{value:t,rows:10,ref:e=>e&&e.addEventListener("pointerdown",a=>a.stopPropagation()),onChange:e=>s(String(e.target.value)),disabled:!0})]}));const qt=window.pug;class Vt extends d.Component{constructor(t,s,e){super("Template");S(this,"path",["New"]);this.data.component=Rt,this.dataSocket=t,this.templateSocket=s,this.htmlSocket=e}builder(t){const s=new d.Input("template","TemplateEngine",this.templateSocket),e=new d.Input("json","Data (JSON)",this.dataSocket),a=new d.Output("html","HTML",this.htmlSocket);return e.addControl(new V(this.editor,"json",t)),t.addInput(s).addInput(e).addControl(new Q(this.editor,"template",t,!0)).addOutput(a)}worker(t,s,e){const a=s.json.length?s.json[0]:t.data.json,o=t.inputs.template.connections.filter(n=>(n==null?void 0:n.output)==="hbs"||(n==null?void 0:n.output)==="pug"),r=(()=>{var c;if(o.length===0)return"No TemplateEngine detected...";const n=o[0].output,i=(c=s.template)!=null&&c.length?s.template[0]:t.data.json;return n==="pug"?qt.render(i,JSON.parse(a)):n==="hbs"?wt.compile(i)(JSON.parse(a)):"Unknown TemplateEngine detected..."})();this.editor.nodes.find(n=>n.id===t.id).controls.get("template").setValue(s,r,"text/html; charset=utf-8"),e.html=r}}const Bt=({value:C,onChange:t})=>{const[s,e]=j.exports.useState(C),[a,o]=j.exports.useState(!1),[r,n]=j.exports.useState(null);return H(()=>{r!==null&&(P(()=>import("./vendor.1ab47a0d.js").then(function(i){return i.q}),[]).then(({toast:i})=>i.error(r)),n(null))},1e4),l("div",{className:"hasScrollbar",style:{overflowY:"auto",maxHeight:"500px"},children:l(q,{textareaClassName:"editorTextarea",preClassName:"line-numbers",value:s,onValueChange:i=>{P(()=>import("./vendor.1ab47a0d.js").then(function(c){return c.h}),[]).then(c=>{c.precompile(i),o(!1),n(null)}).catch(c=>{n(c.message),o(!0)}),e(i),t(i)},highlight:i=>D.exports.highlight(i,D.exports.languages.handlebars).split(`
`).map(c=>`<span class="container_editor_line_number">${c}</span>`).join(`
`),padding:10,style:{fontFamily:'"Fira code", "Fira Mono", monospace',fontSize:12,background:a?"rgba(255, 0, 80, 0.7)":"#FFF",maxWidth:"800px"}})})},nt=class extends d.Control{constructor(t,s,e,a=!1){super(s);this.emitter=t,this.key=s,this.component=nt.component;const o=e.data[s]||"<div>{{name}}</div>";e.data[s]=o,e.data.output=o,this.props={readonly:a,value:o,onChange:r=>{this.setValue(r),this.emitter.trigger("process")}}}setValue(t){this.props.value=t,this.putData(this.key,t),this.putData("output",t),this.update()}};let Y=nt;S(Y,"component",({value:t,onChange:s})=>l("div",{ref:e=>e&&e.addEventListener("pointerdown",a=>a.stopPropagation()),children:l(Bt,{value:t,onChange:e=>s(e)})}));class Ht extends d.Component{constructor(t){super("Handlebars");S(this,"path",["New"]);this.socket=t}builder(t){const s=new d.Output("hbs","Handlebars",this.socket);return t.addControl(new Y(this.editor,"hbs",t)).addOutput(s)}worker(t,s,e){e.hbs=t.data.hbs}}const Wt=window.pug,Kt=({value:C,onChange:t})=>{const[s,e]=j.exports.useState(C),[a,o]=j.exports.useState(!1),[r,n]=j.exports.useState(null);return H(()=>{r!==null&&(P(()=>import("./vendor.1ab47a0d.js").then(function(i){return i.q}),[]).then(({toast:i})=>i.error(r)),n(null))},1e4),l("div",{className:"hasScrollbar",style:{overflowY:"auto",maxHeight:"500px"},children:l(q,{textareaClassName:"editorTextarea",preClassName:"line-numbers",value:s,onValueChange:i=>{try{Wt.compile(i),o(!1),n(null)}catch(c){n(c.message),o(!0)}e(i),t(i)},highlight:i=>D.exports.highlight(i,D.exports.languages.pug).split(`
`).map(c=>`<span class="container_editor_line_number">${c}</span>`).join(`
`),padding:10,style:{fontFamily:'"Fira code", "Fira Mono", monospace',fontSize:12,background:a?"rgba(255, 0, 80, 0.7)":"#FFF",maxWidth:"800px"}})})},at=class extends d.Control{constructor(t,s,e,a=!1){super(s);this.emitter=t,this.key=s,this.component=at.component;const o=e.data[s]||"div #{name}";e.data[s]=o,e.data.output=o,this.props={readonly:a,value:o,onChange:r=>{this.setValue(r),this.emitter.trigger("process")}}}setValue(t){this.props.value=t,this.putData(this.key,t),this.putData("output",t),this.update()}};let z=at;S(z,"component",({value:t,onChange:s})=>l("div",{ref:e=>e&&e.addEventListener("pointerdown",a=>a.stopPropagation()),children:l(Kt,{value:t,onChange:e=>s(e)})}));class Ut extends d.Component{constructor(t){super("Pug");S(this,"path",["New"]);this.socket=t}builder(t){const s=new d.Output("pug","Pug",this.socket);return t.addControl(new z(this.editor,"pug",t)).addOutput(s)}worker(t,s,e){e.pug=t.data.pug}}class Qt extends J{render(){const{bindSocket:t,bindControl:s}=this.props,{outputs:e,controls:a,inputs:o,selected:r}=this.state;return h("div",{className:`node ${r}`,style:{background:"grey"},children:[l("div",{className:"title",children:"Endpoint"}),e.map(n=>h("div",{className:"output",children:[l("div",{className:"output-title",children:n.name}),l(O,{type:"output",socket:n.socket,io:n,innerRef:t})]},n.key)),a.map(n=>l(L,{className:"control",control:n,innerRef:s},n.key)),o.map(n=>h("div",{className:"input",children:[l(O,{type:"input",socket:n.socket,io:n,innerRef:t}),l("div",{className:"input-title",children:n.name})]},n.key))]})}}const ot=class extends d.Control{constructor(t,s,e,a=!1){super(s);this.emitter=t,this.component=ot.component,this.props={readonly:a,value:"",contentType:"",onChange:()=>{}},e.data.output=""}setValue(t,s,e,a,o){this.props.value=s,this.props.contentType=e,this.putData("enabledFlag",a),this.putData("output",s),this.putData("contentType",e),this.putData("path",o),Object.entries(t).forEach(([r,n])=>{n[0]&&this.putData(r,n[0])}),this.update()}};let B=ot;S(B,"component",({value:t,contentType:s,onChange:e})=>h(_,{children:[l("label",{style:{color:"white",display:"block",textAlign:"left"},children:"Preview"}),s==="text/html; charset=utf-8"?l("div",{className:"hasScrollbar",style:{backgroundColor:"white",overflowY:"auto",maxHeight:"500px"},dangerouslySetInnerHTML:{__html:t}}):l("textarea",{value:t,rows:10,ref:a=>a&&a.addEventListener("pointerdown",o=>o.stopPropagation()),onChange:a=>e(String(a.target.value)),disabled:!0})]}));const rt=class extends d.Control{constructor(t,s,e,a=!1,o=""){super(s);this.emitter=t,this.key=s,this.component=rt.component;const r=e.data[s]||!1;e.data[s]=r,e.data.output=r,this.props={readonly:a,checked:r,title:o,onChange:n=>{this.setValue(!!n),this.emitter.trigger("process")}}}setValue(t){this.props.checked=t,this.putData(this.key,t),this.putData("output",t),this.update()}};let F=rt;S(F,"component",({checked:t,onChange:s,title:e,id:a=new Date().getTime()})=>h(_,{children:[e&&l("div",{style:{color:"white",textAlign:"left",marginBottom:"5px"},children:e}),h("div",{className:"switchArea",children:[l("input",{type:"checkbox",id:a,checked:t,ref:o=>o&&o.addEventListener("pointerdown",r=>r.stopPropagation()),onChange:o=>s(+o.target.checked)}),l("label",{htmlFor:a,children:l("span",{})}),l("div",{className:"swImg"})]})]}));const it=class extends d.Control{constructor(t,s,e,a=!1,o="",r=""){super(s);this.emitter=t,this.key=s,this.component=it.component;const n=e.data[s]||"";e.data[s]=n,e.data.output=n,this.props={readonly:a,value:n,title:o,placeHolder:r,onChange:i=>{this.setValue(i),this.emitter.trigger("process")}}}setValue(t){this.props.value=t,this.putData(this.key,t),this.putData("output",t),this.update()}};let I=it;S(I,"component",({value:t,onChange:s,title:e,placeHolder:a})=>h(_,{children:[e&&l("label",{style:{color:"white",display:"block",textAlign:"left"},children:e}),l("input",{type:"text",value:t,placeholder:a,ref:o=>o&&o.addEventListener("pointerdown",r=>r.stopPropagation()),onChange:o=>s(String(o.target.value))})]}));const lt=class extends d.Control{constructor(t,s,e,a=!1,o="",r="",n=!1){super(s);this.emitter=t,this.key=s,this.component=lt.component;const i=e.data[s]||"/foo";e.data[s]=i,e.data.output=i,this.props={readonly:a,value:i,title:o,placeHolder:r,warn:n,onChange:c=>{c===""?this.props.warn=!0:c==="/metrics"||c==="/health"?(this.props.warn=!0,P(()=>import("./vendor.1ab47a0d.js").then(function(k){return k.q}),[]).then(({toast:k})=>k.error("this Path is reserved, use another Path."))):this.props.warn=!1,this.setValue(c),this.emitter.trigger("process")}}}setValue(t){this.props.value=t,this.putData(this.key,t),this.putData("output",t),this.update()}};let R=lt;S(R,"component",({value:t,onChange:s,title:e,placeHolder:a,warn:o})=>h(_,{children:[e&&l("label",{style:{color:"white",display:"block",textAlign:"left"},children:e}),l("input",{type:"text",value:t,placeholder:a,ref:r=>r&&r.addEventListener("pointerdown",n=>n.stopPropagation()),onChange:r=>s(String(r.target.value)),style:{background:o?"rgba(255, 0, 80, 0.7)":"#FFF"}})]}));const ct=class extends d.Control{constructor(t,s,e,a=!1,o="",r=0,n=!1,i=!1){super(s);this.emitter=t,this.key=s,this.component=ct.component;const c=e.data[s]||r;e.data[s]=c,e.data.output=c,this.props={readonly:a,value:c,title:o,disabled:n,hidden:i,onChange:k=>{this.setValue(k),this.emitter.trigger("process")}}}setValue(t,s=!1,e=!1){this.props.value=t,this.props.disabled=s,this.props.hidden=e,this.putData(this.key,t),this.putData("output",t),this.update()}};let T=ct;S(T,"component",({value:t,onChange:s,title:e,disabled:a,hidden:o})=>h("div",{style:{display:o?"none":"block"},children:[e&&l("label",{style:{color:"white",display:"block",textAlign:"left"},children:e}),l("input",{type:"number",value:t,ref:r=>r&&r.addEventListener("pointerdown",n=>n.stopPropagation()),onChange:r=>s(+r.target.value),disabled:a})]}));const pt=class extends d.Control{constructor(t,s,e,a=!1,o="",r=[],n=!1,i=!1){super(s);this.emitter=t,this.key=s,this.component=pt.component;const c=e.data[s]||r[0];e.data[s]=c,e.data.output=c,this.props={readonly:a,value:c,title:o,values:r,disabled:n,hidden:i,onChange:k=>{this.setValue(k),this.emitter.trigger("process")}}}setValue(t,s=!1,e=!1){this.props.value=t,this.props.disabled=s,this.props.hidden=e,this.putData(this.key,t),this.putData("output",t),this.update()}};let $=pt;S($,"component",({title:t,value:s,values:e,onChange:a,disabled:o,hidden:r})=>h("div",{style:{display:r?"none":"block"},children:[t&&l("label",{style:{color:"white",display:"block",textAlign:"left"},children:t}),l("select",{style:{width:"100%"},value:s,ref:n=>n&&n.addEventListener("pointerdown",i=>i.stopPropagation()),onChange:n=>a(String(n.target.value)),disabled:o,children:e.map((n,i)=>l("option",{value:n,children:n},`${n}_${i}`))})]}));class Yt extends d.Component{constructor(t){super("Endpoint");S(this,"path",["New"]);this.data.component=Qt,this.stringSocket=t}builder(t){var e;t.data.enabledFlag=(e=t.data.enabledFlag)!=null?e:!0;const s=new d.Input("content","Content (JSON/HTML)",this.stringSocket);return s.addControl(new I(this.editor,"content",t)),t.addInput(s).addControl(new B(this.editor,"endpoint",t,!0)).addControl(new F(this.editor,"enabledFlag",t,!1,"Enabled")).addControl(new $(this.editor,"method",t,!1,"Method",["GET","POST","PUT","PATCH","DELETE","OPTIONS"])).addControl(new R(this.editor,"path",t,!1,"Path","/foo")).addControl(new F(this.editor,"botblockerEnableFlag",t,!1,"BotBlocker")).addControl(new F(this.editor,"ratelimitEnableFlag",t,!1,"RateLimit")).addControl(new $(this.editor,"ratelimitUnit",t,!1,"Unit",["any","ip"])).addControl(new T(this.editor,"ratelimitLimit",t,!1,"Limit",30)).addControl(new T(this.editor,"ratelimitBurst",t,!1,"Burst",0)).addControl(new T(this.editor,"ratelimitExpireSecond",t,!1,"ExpireSecond",60))}worker(t,s){const e=s.content.length?s.content[0]:"Rendering...",a=(n=>{if(n){if(n.output==="html")return"text/html; charset=utf-8";if(n.output==="json")return"application/json; charset=utf-8"}return"text/plain; charset=utf-8"})(t.inputs.content.connections[0]),{enabledFlag:o}=t.data,{path:r}=t.data;this.editor.nodes.find(n=>n.id===t.id).controls.get("endpoint").setValue(s,e,a,o,r),["ratelimitUnit","ratelimitLimit","ratelimitBurst","ratelimitExpireSecond"].forEach(n=>{this.editor.nodes.find(i=>i.id===t.id).controls.get(n).setValue(t.data[n],!t.data.ratelimitEnableFlag,!t.data.ratelimitEnableFlag)})}}class zt extends J{render(){const{bindSocket:t,bindControl:s}=this.props,{outputs:e,controls:a,inputs:o,selected:r}=this.state;return h("div",{className:`node ${r}`,style:{background:"grey"},children:[l("div",{className:"title",children:"EndpointWithError"}),e.map(n=>h("div",{className:"output",children:[l("div",{className:"output-title",children:n.name}),l(O,{type:"output",socket:n.socket,io:n,innerRef:t})]},n.key)),a.map(n=>l(L,{className:"control",control:n,innerRef:s},n.key)),o.map(n=>h("div",{className:"input",children:[l(O,{type:"input",socket:n.socket,io:n,innerRef:t}),l("div",{className:"input-title",children:n.name})]},n.key))]})}}class Gt extends d.Component{constructor(t,s){super("EndpointWithError");S(this,"path",["New"]);this.data.component=zt,this.stringSocket=t,this.errorSocket=s}builder(t){var a;t.data.enabledFlag=(a=t.data.enabledFlag)!=null?a:!0;const s=new d.Input("content","Content (JSON/HTML)",this.stringSocket);s.addControl(new I(this.editor,"content",t));const e=new d.Input("error","Error (JSON/HTML)",this.errorSocket);return e.addControl(new I(this.editor,"error",t)),t.addInput(s).addInput(e).addControl(new B(this.editor,"endpoint",t,!0)).addControl(new F(this.editor,"enabledFlag",t,!1,"Enabled")).addControl(new $(this.editor,"method",t,!1,"Method",["GET","POST","PUT","PATCH","DELETE","OPTIONS"])).addControl(new R(this.editor,"path",t,!1,"Path","/foo")).addControl(new F(this.editor,"botblockerEnableFlag",t,!1,"BotBlocker")).addControl(new F(this.editor,"ratelimitEnableFlag",t,!1,"RateLimit")).addControl(new $(this.editor,"ratelimitUnit",t,!1,"Unit",["any","ip"])).addControl(new T(this.editor,"ratelimitLimit",t,!1,"Limit",30)).addControl(new T(this.editor,"ratelimitBurst",t,!1,"Burst",0)).addControl(new T(this.editor,"ratelimitExpireSecond",t,!1,"ExpireSecond",60))}worker(t,s){const e=s.content.length?s.content[0]:"Rendering...",a=(n=>{if(n){if(n.output==="html")return"text/html; charset=utf-8";if(n.output==="json")return"application/json; charset=utf-8"}return"text/plain; charset=utf-8"})(t.inputs.content.connections[0]),{enabledFlag:o}=t.data,{path:r}=t.data;this.editor.nodes.find(n=>n.id===t.id).controls.get("endpoint").setValue(s,e,a,o,r),["ratelimitUnit","ratelimitLimit","ratelimitBurst","ratelimitExpireSecond"].forEach(n=>{this.editor.nodes.find(i=>i.id===t.id).controls.get(n).setValue(t.data[n],!t.data.ratelimitEnableFlag,!t.data.ratelimitEnableFlag)})}}class Xt extends J{render(){const{bindSocket:t,bindControl:s}=this.props,{outputs:e,controls:a,inputs:o,selected:r}=this.state;return h("div",{className:`node ${r}`,style:{background:"grey"},children:[l("div",{className:"title",children:"JSONManager"}),e.map(n=>h("div",{className:"output",children:[l("div",{className:"output-title",children:n.name}),l(O,{type:"output",socket:n.socket,io:n,innerRef:t})]},n.key)),a.map(n=>l(L,{className:"control",control:n,innerRef:s},n.key)),o.map(n=>h("div",{className:"input jsonManagerInput",children:[l(O,{type:"input",socket:n.socket,io:n,innerRef:t}),l("div",{className:"input-title",children:n.name})]},n.key))]})}}const dt=class extends d.Control{constructor(t,s,e,a=!1){super(s);this.emitter=t,this.component=dt.component,this.props={readonly:a,inputs:[],inputIds:[],outputs:e.data.output?JSON.parse(e.data.output):[],state:{pointerPos:{x:0,y:0},drag:{},selectedElement:{}},isDroppable:!1,onPointerOver:()=>{this.props.isDroppable=!0},onPointerOut:()=>{this.props.isDroppable=!1},onPointerDown:o=>{const r=o.currentTarget;this.props.state.pointerPos.x=o.clientX,this.props.state.pointerPos.y=o.clientY,this.props.state.selectedElement=r;const n=r.cloneNode(!0),i=n.style;i.transition="",i.pointerEvents="none",i.display="none",i.position="absolute";const c=10,k=/^.*scale\((.*)\)$/,E=document.getElementsByClassName("minimap")[0].previousElementSibling.style.transform.match(k)[1],b=(r.getBoundingClientRect().left-r.closest(".jsonManagerCtrl").getBoundingClientRect().left)/E+c;i.left=`${b}px`,r.after(n);const{left:N,top:m}=r.getBoundingClientRect(),w={x:N,y:m};this.props.state.drag={dragElement:n,position:w},r.classList.remove("jsonManagerCtrlInputKeyHover");const v=r.closest(".node");v.style.cursor="grabbing",v.addEventListener("pointerup",this.props.onPointerUp),v.addEventListener("pointermove",this.props.onPointerMove)},onPointerMove:o=>{o.stopPropagation();const r=/^.*scale\((.*)\)$/,i=document.getElementsByClassName("minimap")[0].previousElementSibling.style.transform.match(r)[1],{clientX:c,clientY:k}=o,{drag:u,pointerPos:E}=this.props.state,b=(c-E.x)/i,N=(k-E.y)/i,m=u.dragElement.style;m.display="inline-block",m.zIndex="100",m.transform=`translate(${b}px,${N}px)`},onPointerUp:()=>{const{drag:o,selectedElement:r}=this.props.state;this.props.state.drag=null,r.classList.add("jsonManagerCtrlInputKeyHover");const n=r.closest(".node");if(n.style.cursor="pointer",n.removeEventListener("pointerup",this.props.onPointerUp),n.removeEventListener("pointermove",this.props.onPointerMove),this.props.isDroppable){const i=parseInt(r.dataset.idx,10),c=parseInt(r.dataset.nodeid,10),k=r.innerText;if(r.dataset.type!=="func")this.props.outputs.filter(u=>u.key===k).length===1?this.props.outputs=this.props.outputs.map(u=>u.key===k?{srcId:c,srcIds:"",src:i,key:u.key,value:JSON.stringify(JSON.parse(this.props.inputs[i])[u.key])}:u):this.props.outputs.push({srcId:c,srcIds:"",src:i,key:k,value:JSON.stringify(JSON.parse(this.props.inputs[i])[k])});else{const{params:u}=this.props.outputFunctions[i],E=this.props.functions.filter(y=>y.name===this.props.outputFunctions[i].func)[0],{paramCount:b,logic:N}=E,{p0:m,p0Id:w}=(()=>{if(u[0].startsWith("inputs[")){const x=/^inputs\[(\d+)\](([^.]?)|\.(.*))$/.exec(u[0]),M=x[1],A=x[4];return A?{p0:JSON.parse(this.props.inputs[M])[A],p0Id:M}:{p0:JSON.parse(this.props.inputs[M]),p0Id:M}}return{p0:u[0],p0Id:null}})(),{p1:v,p1Id:f}=(()=>{if(b===2&&u[1].startsWith("inputs[")){const x=/^inputs\[(\d+)\](([^.]?)|\.(.*))$/.exec(u[1]),M=x[1],A=x[4];return A?{p1:JSON.parse(this.props.inputs[M])[A],p1Id:M}:{p1:JSON.parse(this.props.inputs[M]),p1Id:M}}return{p1:u[1],p1Id:null}})(),g=b===1?N(m):N(m,v),p=(()=>b===1?w!==null?`${w}:${parseInt(document.querySelectorAll(`.jsonManagerCtrlInputKey[data-idx='${w}']`)[0].dataset.nodeid,10)}`:"":w==null&&f==null?"":w==null?`${f}:${parseInt(document.querySelectorAll(`.jsonManagerCtrlInputKey[data-idx='${f}']`)[0].dataset.nodeid,10)}`:`${w}:${parseInt(document.querySelectorAll(`.jsonManagerCtrlInputKey[data-idx='${w}']`)[0].dataset.nodeid,10)}`)();this.props.outputs.filter(y=>y.key===k).length===1?this.props.outputs=this.props.outputs.map(y=>y.key===k?{srcId:-1,srcIds:p,src:(i+1)*-1,key:y.key,value:JSON.stringify(g)}:y):this.props.outputs.push({srcId:-1,srcIds:p,src:(i+1)*-1,key:k,value:JSON.stringify(g)})}this.putData("output",JSON.stringify(this.props.outputs)),this.update(),this.emitter.trigger("process")}o.dragElement.remove()},onClickCloseBtn:o=>{const r=o.currentTarget;this.props.outputs=this.props.outputs.reduce((n,i)=>i.key===r.dataset.key?n:[...n,i],[]),this.putData("output",JSON.stringify(this.props.outputs)),this.update(),this.emitter.trigger("process")},isModalOpen:!1,setModalOpen:o=>{this.props.isModalOpen=o,this.update(),this.emitter.trigger("process")},outputFunctions:!(Array.isArray(e.data.outputFunctions)&&e.data.outputFunctions.length===0)&&e.data.outputFunctions?JSON.parse(e.data.outputFunctions):[],functions:[{name:"Naming",paramCount:1,symbol:null,logic:o=>o}],onClickAddBtn:o=>{const r=o.currentTarget.previousElementSibling.value;r!==""&&(this.props.outputFunctions.push({func:r,name:"",params:[],warn:!1}),this.putData("outputFunctions",JSON.stringify(this.props.outputFunctions)),this.update(),this.emitter.trigger("process"))},onClickRemoveBtn:o=>{const r=parseInt(o.currentTarget.dataset.idx,10),{name:n}=this.props.outputFunctions[r];this.props.outputs=this.props.outputs.filter(i=>i.key!==n),this.props.outputFunctions=this.props.outputFunctions.filter((i,c)=>c!==r),this.putData("outputFunctions",JSON.stringify(this.props.outputFunctions)),this.update(),this.emitter.trigger("process")},onChangeModalFunc:o=>{const r=parseInt(o.currentTarget.dataset.idx,10);this.props.outputFunctions.filter(n=>n.name===o.target.value).length===1?this.props.outputFunctions[r].warn=!0:this.props.outputFunctions[r].warn=!1,this.props.outputFunctions[r].name=o.target.value,this.putData("outputFunctions",JSON.stringify(this.props.outputFunctions)),this.update(),this.emitter.trigger("process")},onChangeModalFuncParams:o=>{const r=parseInt(o.currentTarget.dataset.idx,10),n=parseInt(o.currentTarget.dataset.paramsIdx,10);if(n===2&&this.props.outputFunctions[r].params.length<2&&(this.props.outputFunctions[r].params[0]=null),this.props.outputFunctions[r].params[n]=o.target.value,this.putData("outputFunctions",JSON.stringify(this.props.outputFunctions)),this.props.outputFunctions[r].name){const i=this.props.outputFunctions[r].name,{params:c}=this.props.outputFunctions[r],k=this.props.functions.filter(b=>b.name===this.props.outputFunctions[r].func)[0],{paramCount:u,logic:E}=k;if(u===1||c[0]){const{p0:b,p0Id:N}=(()=>{if(c[0].startsWith("inputs[")){const p=/^inputs\[(\d+)\](([^.]?)|\.(.*))$/.exec(c[0]),y=p[1],x=p[4];return x?{p0:JSON.parse(this.props.inputs[y])[x],p0Id:y}:{p0:JSON.parse(this.props.inputs[y]),p0Id:y}}return{p0:c[0],p0Id:null}})(),{p1:m,p1Id:w}=(()=>{if(u===2&&c[1].startsWith("inputs[")){const p=/^inputs\[(\d+)\](([^.]?)|\.(.*))$/.exec(c[1]),y=p[1],x=p[4];return x?{p1:JSON.parse(this.props.inputs[y])[x],p1Id:y}:{p1:JSON.parse(this.props.inputs[y]),p1Id:y}}return{p1:c[1],p1Id:null}})(),v=u===1?E(b):E(b,m),f=(()=>u===1?N!==null?`${N}:${parseInt(document.querySelectorAll(`.jsonManagerCtrlInputKey[data-idx='${N}']`)[0].dataset.nodeid,10)}`:"":N==null&&w==null?"":N==null?`${w}:${parseInt(document.querySelectorAll(`.jsonManagerCtrlInputKey[data-idx='${w}']`)[0].dataset.nodeid,10)}`:`${N}:${parseInt(document.querySelectorAll(`.jsonManagerCtrlInputKey[data-idx='${N}']`)[0].dataset.nodeid,10)}`)();this.props.outputs.filter(g=>g.key===i).length===1&&(this.props.outputs=this.props.outputs.map(g=>g.key===i?{srcId:-1,srcIds:f,src:(r+1)*-1,key:g.key,value:JSON.stringify(v)}:g))}}this.update(),this.emitter.trigger("process")},textAreaRef:ut.createRef(),previewRef:ut.createRef()}}setValue(t,s){const e=t.inputs.content.connections.map(o=>o.node),{content:a}=s;this.props.inputs=a,this.props.inputIds=e,a.length===0&&(this.props.outputs=[],this.props.outputFunctions=[]),e.length>a.length?(this.props.outputs=[],this.props.outputFunctions=[]):(a.forEach((r,n)=>this.props.outputs=this.props.outputs.reduce((i,c)=>{if(c.src===n){const k=JSON.parse(r);return Object.keys(k).includes(c.key)?[...i,{srcId:c.srcId,srcIds:c.srcIds,src:c.src,key:c.key,value:JSON.stringify(k[c.key])}]:i}return[...i,c]},[])),this.props.outputFunctions.filter(r=>r.name&&r.params.reduce((n,i)=>n||i.startsWith("inputs["),!1)).length&&(this.props.outputFunctions.forEach((r,n)=>{try{const i=r.name,{params:c}=r,k=this.props.functions.filter(b=>b.name===r.func)[0],{paramCount:u,logic:E}=k;if(u===1||c[0]){const b=(()=>{if(c[0]!==void 0&&c[0].startsWith("inputs[")){const v=/^inputs\[(\d+)\](([^.]?)|\.(.*))$/.exec(c[0]),f=v[1],g=v[4],p=g?JSON.parse(this.props.inputs[f])[g]:JSON.parse(this.props.inputs[f]);if(p===void 0)throw Error;return p}return c[0]})(),N=(()=>{if(u===2&&c[1]!==void 0&&c[1].startsWith("inputs[")){const v=/^inputs\[(\d+)\](([^.]?)|\.(.*))$/.exec(c[1]),f=v[1],g=v[4],p=g?JSON.parse(this.props.inputs[f])[g]:JSON.parse(this.props.inputs[f]);if(p===void 0)throw Error;return p}return c[1]})(),m=u===1?E(b):E(b,N);this.props.outputs.filter(w=>w.key===i).length===1&&(this.props.outputs=this.props.outputs.map(w=>w.key===i?{srcId:w.srcId,srcIds:w.srcIds,src:w.src,key:w.key,value:JSON.stringify(m)}:w))}}catch{this.props.outputs=this.props.outputs.filter(c=>c.key!==this.props.outputFunctions[n].name),delete this.props.outputFunctions[n]}}),this.props.outputFunctions=this.props.outputFunctions.filter(r=>r!==void 0))),this.putData("output",JSON.stringify(this.props.outputs)),this.update()}};let G=dt;S(G,"component",({inputs:t,inputIds:s,outputs:e,onPointerDown:a,onPointerOver:o,onPointerOut:r,onClickCloseBtn:n,isModalOpen:i,setModalOpen:c,functions:k,onClickAddBtn:u,onChangeModalFunc:E,outputFunctions:b,onClickRemoveBtn:N,onChangeModalFuncParams:m,textAreaRef:w,previewRef:v})=>h("div",{className:"jsonManagerCtrl",children:[h(mt,{isOpen:i,style:{content:{padding:"0px"}},children:[h("div",{className:"jsonManagerModalTitle",children:[l("p",{style:{display:"inline-block",fontWeight:"600",fontSize:"18px"},children:"Functions"}),l("span",{role:"button",tabIndex:"0",className:"closeBtn",onClick:()=>c(!1)})]}),h("div",{className:"jsonManagerModalContent",children:[h("select",{style:{color:"#767676"},ref:f=>f&&f.addEventListener("pointerdown",g=>g.stopPropagation()),children:[l("option",{value:"",style:{display:"none"},children:"Select your function"}),k.map(f=>l("option",{value:f.name,children:f.name},f.name))]}),l("div",{role:"button",tabIndex:"0",className:"modalAddBtn",onClick:u,children:"Add"}),b.map((f,g)=>h("div",{className:"modalFunction",children:[h("p",{className:"modalFunctionTitle",children:[f.func,l("span",{role:"button",tabIndex:"0",className:"removeBtn",onClick:N,"data-idx":g})]}),h("div",{className:"modalFunctionKey",children:[l("p",{className:"modalFunctionKeyTitle",children:"name:"}),l("input",{type:"text",value:f.name,placeholder:"name to use output",ref:p=>{p&&p.addEventListener("pointerdown",y=>y.stopPropagation())},onChange:E,"data-idx":g,style:{background:f.warn?"rgba(255, 0, 80, 0.7)":"#FFF"}})]}),h("div",{className:"modalFunctionKey",children:[l("p",{className:"modalFunctionKeyTitle",children:"params: "}),l("div",{className:"modalFunctionContent",children:(()=>{const p=k.filter(y=>y.name===f.func)[0];return p.paramCount===1?l("input",{className:"modalFunctionContentInput",list:"inputs-datalist",name:`func-${g}_0`,placeholder:"Input or Select your param",onChange:m,"data-idx":g,"data-params-idx":0,value:f.params[0]?f.params[0]:""}):h(_,{children:[l("input",{className:"modalFunctionContentInput",list:"inputs-datalist",name:`func-${g}_0`,placeholder:"Input or Select your param",onChange:m,"data-idx":g,"data-params-idx":0,value:f.params[0]?f.params[0]:null}),l("span",{className:"modalFunctionContentSymbol",children:p.symbol}),l("input",{className:"modalFunctionContentInput",list:"inputs-datalist",name:`func-${g}_1`,placeholder:"Input or Select your param",onChange:m,"data-idx":g,"data-params-idx":1,value:f.params[1]?f.params[1]:null})]})})()})]})]},`modalFunction_${g}`)),l("datalist",{id:"inputs-datalist",children:t.map((f,g)=>{try{const p=JSON.parse(f);return(()=>[...Array.isArray(p)?[l("option",{value:`inputs[${g}]`,children:`inputs[${g}]`},`inputs[${g}]`)]:[],...Object.keys(p).map(x=>l("option",{value:`inputs[${g}].${x}`,children:`inputs[${g}].${x}`},`inputs[${g}].${x}`))])()}catch{return""}})})]})]}),h("div",{className:"jsonManagerCtrlInputs",children:[h("div",{className:"jsonManagerCtrlInput",children:[l("p",{className:"jsonManagerCtrlCategory",children:"Inputs"}),t.map((f,g)=>{try{const p=JSON.parse(f);return Array.isArray(p)?h("div",{className:"jsonManagerCtrlInputGroup",children:[h("p",{className:"jsonManagerCtrlInputTitle",children:["inputs[",g,"]"]}),l("p",{className:"jsonManagerCtrlInputKey","data-nodeid":s[g],children:"Array"})]},`jsonManagerCtrlInputGroup_${g}`):h("div",{className:"jsonManagerCtrlInputGroup",children:[h("p",{className:"jsonManagerCtrlInputTitle",children:["inputs[",g,"]"]}),Object.keys(p).map((y,x)=>l("p",{className:"jsonManagerCtrlInputKey jsonManagerCtrlInputKeyHover",onPointerDown:a,"data-idx":g,"data-nodeid":s[g],children:y},`jsonManagerCtrlInputKey_${x}`))]},`jsonManagerCtrlInputGroup_${g}`)}catch{return""}})]}),h("div",{className:"jsonManagerCtrlFunctions",children:[h("p",{className:"jsonManagerCtrlCategory",children:["Functions",l("span",{role:"button",tabIndex:"0",className:"addBtn",onClick:()=>c(!0)})]}),l("div",{className:"jsonManagerCtrlInputGroup",children:b.map((f,g)=>f.name!==""&&h("p",{className:"jsonManagerCtrlInputKey jsonManagerCtrlInputKeyHover",onPointerDown:a,"data-idx":g,"data-type":"func",children:[f.name,l("span",{role:"button",tabIndex:"0",className:"removeBtn",onClick:N,"data-idx":g})]},`jsonManagerCtrlInputKey_${g}_func`))})]})]}),l("div",{className:"jsonManagerCtrlHint",children:">>>"}),h("div",{className:"jsonManagerCtrlOutputs",children:[h("div",{className:"jsonManagerCtrlPreview",style:{height:w&&v&&w.current&&v.current?`${w.current.scrollHeight+v.current.scrollHeight}px`:"initial",maxHeight:"200px"},children:[l("p",{className:"jsonManagerCtrlCategory",ref:v,children:"Preview"}),l("textarea",{disabled:!0,ref:w,className:"jsonManagerCtrlPreviewArea hasScrollbar",value:e.length!==0?JSON.stringify(Object.fromEntries(e.map(f=>[f.key,f.value?JSON.parse(f.value):""])),null,2):""})]}),h("div",{className:"jsonManagerCtrlOutput",onPointerOver:o,onPointerOut:r,children:[l("p",{className:"jsonManagerCtrlCategory",children:"Outputs"}),l("div",{className:"jsonManagerCtrlOutputArea",children:e.map((f,g)=>h("p",{className:"jsonManagerCtrlOutputKey",children:[f.key,l("span",{role:"button",tabIndex:"0",className:"removeBtn",onClick:n,"data-key":f.key})]},`jsonManagerCtrlOutputKey_${g}`))})]})]})]}));class Zt extends d.Component{constructor(t){super("JSONManager");S(this,"path",["New"]);this.data.component=Xt,this.jsonSocket=t}builder(t){const s=new d.Input("content","JSONs",this.jsonSocket,!0),e=new d.Output("json","JSON",this.jsonSocket);return t.addInput(s).addControl(new G(this.editor,"jsonManager",t,!0)).addOutput(e)}worker(t,s,e){if(this.editor.nodes.find(a=>a.id===t.id).controls.get("jsonManager").setValue(t,s),t.data.output==="[]")e.json="";else if(t.data.output!==""){const a=JSON.parse(t.data.output).map(o=>[o.key,JSON.parse(o.value)]);e.json=JSON.stringify(Object.fromEntries(a))}e.outputFunctions=t.data.outputFunctions}}class X extends J{render(){const{node:t,bindSocket:s,bindControl:e}=this.props,{outputs:a,controls:o,inputs:r,selected:n}=this.state;return h("div",{className:`node ${n}`,style:{background:"grey"},children:[l("div",{className:"title",children:t.name}),a.map(i=>h("div",{className:"output",children:[l("div",{className:"output-title",children:i.name}),l(O,{type:"output",socket:i.socket,io:i,innerRef:s})]},i.key)),o.map(i=>l(L,{className:"control",control:i,innerRef:e},i.key)),r.map(i=>h("div",{className:"input",children:[l(O,{type:"input",socket:i.socket,io:i,innerRef:s}),!i.showControl()&&l("div",{className:"input-title",children:i.name}),i.showControl()&&l(L,{className:"input-control",control:i.control,innerRef:e})]},i.key))]})}}class te extends d.Component{constructor(t){super("API");S(this,"path",["New"]);this.data.component=X,this.jsonSocket=t}builder(t){const s=new d.Input("json","Dummy Output (JSON)",this.jsonSocket),e=new d.Output("json","JSON",this.jsonSocket);return t.addInput(s).addControl(new $(this.editor,"method",t,!1,"Method",["GET","POST","PUT","PATCH","DELETE","OPTIONS"])).addControl(new I(this.editor,"url",t,!1,"URL","https://example.com/bar")).addControl(new F(this.editor,"cached",t,!1,"Cached (In-Memory)")).addControl(new T(this.editor,"cacheTime",t,!1,"CacheTime (seconds)",30)).addOutput(e)}worker(t,s,e){e.json=s.json.length?s.json[0]:t.data.json,e.url=t.data.url,e.cached=t.data.cached,this.editor.nodes.find(a=>a.id===t.id).controls.get("cacheTime").setValue(t.data.cacheTime,!t.data.cached,!t.data.cached)}}class gt extends J{render(){const{node:t,bindSocket:s,bindControl:e}=this.props,{outputs:a,controls:o,inputs:r,selected:n}=this.state,i=o.filter(u=>u.key==="db").map(u=>u.props.value===""?"DB":u.props.value.toUpperCase())[0],c=o.filter(u=>u.key==="user").map(u=>u.props.value===""?"USER":u.props.value.toUpperCase())[0],k=`${i}_PASS_ON_${c}`;return h("div",{className:`node ${n}`,style:{background:"grey"},children:[l("div",{className:"title",children:t.name}),a.map(u=>h("div",{className:"output",children:[l("div",{className:"output-title",children:u.name}),l(O,{type:"output",socket:u.socket,io:u,innerRef:s})]},u.key)),o.map(u=>h(_,{children:[l(L,{className:"control",control:u,innerRef:e},u.key),u.key==="db"&&h("div",{className:"control",title:"pass",children:[l("label",{style:{color:"white",display:"block",textAlign:"left"},children:"DB_PASS"}),l("textarea",{rows:"3",placeholder:`set ${k} when tuna api starting`,value:"",disabled:!0})]})]})),r.map(u=>h("div",{className:"input",children:[l(O,{type:"input",socket:u.socket,io:u,innerRef:s}),!u.showControl()&&l("div",{className:"input-title",children:u.name}),u.showControl()&&l(L,{className:"input-control",control:u.control,innerRef:e})]},u.key))]})}}class ee extends d.Component{constructor(t,s){super("MySQL");S(this,"path",["New"]);this.data.component=gt,this.jsonSocket=t,this.sqlSocket=s}builder(t){const s=new d.Input("json","Dummy Output (JSON)",this.jsonSocket),e=new d.Output("json","JSON",this.jsonSocket),a=new d.Input("sql","SQL",this.sqlSocket);return t.addInput(a).addInput(s).addControl(new $(this.editor,"tls",t,!1,"TLS",["false","true","skip-verify","preferred"])).addControl(new I(this.editor,"host",t,!1,"HOST","127.0.0.1")).addControl(new I(this.editor,"port",t,!1,"PORT","3306")).addControl(new I(this.editor,"user",t,!1,"USER","guest")).addControl(new I(this.editor,"db",t,!1,"DB_NAME","foo")).addControl(new F(this.editor,"cached",t,!1,"Cached (In-Memory)")).addControl(new T(this.editor,"cacheTime",t,!1,"CacheTime (seconds)",30)).addOutput(e)}worker(t,s,e){e.json=s.json.length?s.json[0]:t.data.json,e.sql=s.sql.length?s.sql[0]:t.data.sql,e.tls=t.data.tls,e.host=t.data.host,e.port=t.data.port,e.user=t.data.user,e.db=t.data.db,e.cached=t.data.cached,e.cacheTime=t.data.cacheTime,this.editor.nodes.find(a=>a.id===t.id).controls.get("cacheTime").setValue(t.data.cacheTime,!t.data.cached,!t.data.cached)}}class se extends d.Component{constructor(t,s){super("PostgreSQL");S(this,"path",["New"]);this.data.component=gt,this.jsonSocket=t,this.sqlSocket=s}builder(t){const s=new d.Input("json","Dummy Output (JSON)",this.jsonSocket),e=new d.Output("json","JSON",this.jsonSocket),a=new d.Input("sql","SQL",this.sqlSocket);return t.addInput(a).addInput(s).addControl(new $(this.editor,"tls",t,!1,"SSLMODE",["disable","require","verify-ca","verify-full"])).addControl(new I(this.editor,"host",t,!1,"HOST","127.0.0.1")).addControl(new I(this.editor,"port",t,!1,"PORT","5432")).addControl(new I(this.editor,"user",t,!1,"USER","guest")).addControl(new I(this.editor,"db",t,!1,"DB_NAME","foo")).addControl(new F(this.editor,"cached",t,!1,"Cached (In-Memory)")).addControl(new T(this.editor,"cacheTime",t,!1,"CacheTime (seconds)",30)).addOutput(e)}worker(t,s,e){e.json=s.json.length?s.json[0]:t.data.json,e.sql=s.sql.length?s.sql[0]:t.data.sql,e.sslmode=t.data.sslmode,e.host=t.data.host,e.port=t.data.port,e.user=t.data.user,e.db=t.data.db,e.cached=t.data.cached,e.cacheTime=t.data.cacheTime,this.editor.nodes.find(a=>a.id===t.id).controls.get("cacheTime").setValue(t.data.cacheTime,!t.data.cached,!t.data.cached)}}class ne extends J{render(){const{node:t,bindSocket:s,bindControl:e}=this.props,{outputs:a,controls:o,inputs:r,selected:n}=this.state;return h("div",{className:`node ${n}`,style:{background:"grey"},children:[l("div",{className:"title",children:t.name}),a.map(i=>h("div",{className:"output",children:[l("div",{className:"output-title",children:i.name}),l(O,{type:"output",socket:i.socket,io:i,innerRef:s})]},i.key)),o.map(i=>l(L,{className:"control",control:i,innerRef:e},i.key)),r.map(i=>h("div",{className:"input",children:[l(O,{type:"input",socket:i.socket,io:i,innerRef:s}),!i.showControl()&&l("div",{className:"input-title",children:i.name}),i.showControl()&&l(L,{className:"input-control",control:i.control,innerRef:e})]},i.key))]})}}class ae extends d.Component{constructor(t,s){super("SQLite");S(this,"path",["New"]);this.data.component=ne,this.jsonSocket=t,this.sqlSocket=s}builder(t){const s=new d.Input("json","Dummy Output (JSON)",this.jsonSocket),e=new d.Output("json","JSON",this.jsonSocket),a=new d.Input("sql","SQL",this.sqlSocket);return t.addInput(a).addInput(s).addControl(new I(this.editor,"filename",t,!1,"FILE_NAME","test.db")).addControl(new F(this.editor,"cached",t,!1,"Cached (In-Memory)")).addControl(new T(this.editor,"cacheTime",t,!1,"CacheTime (seconds)",30)).addOutput(e)}worker(t,s,e){e.json=s.json.length?s.json[0]:t.data.json,e.sql=s.sql.length?s.sql[0]:t.data.sql,e.filename=t.data.filename,e.cached=t.data.cached,e.cacheTime=t.data.cacheTime,this.editor.nodes.find(a=>a.id===t.id).controls.get("cacheTime").setValue(t.data.cacheTime,!t.data.cached,!t.data.cached)}}class oe extends d.Component{constructor(t){super("Request");S(this,"path",["New"]);this.data.component=X,this.jsonSocket=t}builder(t){const s=new d.Input("json","Dummy Output (JSON)",this.jsonSocket),e=new d.Output("json","JSON",this.jsonSocket);return t.addInput(s).addControl(new $(this.editor,"type",t,!1,"Type",["QUERY","COOKIE","BODY"])).addOutput(e)}worker(t,s,e){e.json=s.json.length?s.json[0]:t.data.json,e.type=t.data.type}}class re extends d.Component{constructor(){super("RedirectEndpoint");S(this,"path",["New"]);this.data.component=X}builder(t){var s;return t.data.enabledFlag=(s=t.data.enabledFlag)!=null?s:!0,t.addControl(new F(this.editor,"enabledFlag",t,!1,"Enabled")).addControl(new R(this.editor,"path",t,!1,"Path","/foo")).addControl(new I(this.editor,"url",t,!1,"Url","https://example.com"))}worker(t,s,e){e.enabledFlag=t.data.enabledFlag,e.path=t.data.path,e.url=t.data.url}}async function ie(C){const t=new d.Socket("String value"),s=new d.Socket("Error value"),e=new d.Socket("Json value");e.combineWith(t);const a=new d.Socket("raw Json value");a.combineWith(s),a.combineWith(e),a.combineWith(t);const o=new d.Socket("Template value");o.combineWith(t);const r=new d.Socket("Handlebars value");r.combineWith(o);const n=new d.Socket("Pug value");n.combineWith(o);const i=new d.Socket("HTML value");i.combineWith(t);const c=new d.Socket("HTML Json value");c.combineWith(s),c.combineWith(i),c.combineWith(t);const k=new d.Socket("SQL value"),u=[new Yt(t),new Gt(t,s),new Zt(e),new Lt(a),new Jt(c),new Vt(e,o,i),new Ht(r),new Ut(n),new At(k),new te(e),new ee(e,k),new se(e,k),new ae(e,k),new oe(e),new re],b=window.navigator.userAgent.toLowerCase().indexOf("mac os x")!==-1,N=()=>{const{nodeName:p}=document.activeElement;return p==="TEXTAREA"||p==="INPUT"},m=new d.NodeEditor("tuna-mayonnaise@0.0.1",C);m.use(St),m.use(Nt);const w=()=>{P(()=>import("./vendor.1ab47a0d.js").then(function(p){return p.q}),[]).then(({toast:p})=>p.error("NOT CONNECTED :("))};m.use(bt,{searchBar:!1,delay:100,allocate(p){return p.path},rename(p){return p.name},items:{Arrange(){m.nodes.forEach(p=>{m.trigger("arrange",p)})},Undo(){m.trigger("undo")},Redo(){m.trigger("redo")},Save(){fetch("/regist",{method:"POST",body:JSON.stringify(m.toJSON()),headers:{"Content-Type":"application/json"}}).then(p=>{p.ok?P(()=>import("./vendor.1ab47a0d.js").then(function(y){return y.q}),[]).then(({toast:y})=>y.success("SAVED :)")):w()}).catch(()=>w())},Download(){const p=new Blob([JSON.stringify(m.toJSON())],{type:"application/json; charset=utf-8"});P(()=>import("./FileSaver.min.55fa3eb9.js").then(function(y){return y.F}),["assets/FileSaver.min.55fa3eb9.js","assets/vendor.1ab47a0d.js"]).then(({saveAs:y})=>y(p,"tuna-mayonnaise.json"))},Debug(){console.log(JSON.stringify(m.toJSON()))}}}),m.on("zoom",({source:p})=>p!=="dblclick"&&p==="wheel"&&!N()),m.use(vt,{keyboard:!1}),m.on("keydown",p=>{if(!N()){switch(p.code){case"Delete":case"Backspace":m.selected.each(y=>{m.removeNode(y)}),m.selected.clear();return;case"Space":{const y=m.view.container.getBoundingClientRect(),x=new PointerEvent("contextmenu",{clientX:y.left+y.width/2,clientY:y.top+y.height/2});m.trigger("contextmenu",{e:x,view:m.view});return}}if(p.ctrlKey||b&&p.metaKey)switch(p.code){case"KeyY":m.trigger("redo");return;case"KeyZ":p.shiftKey?m.trigger("redo"):m.trigger("undo");break}}}),m.use(xt),m.use(W,{type:W.DEFAULT,transformer:()=>([p,y,x,M])=>[[p,y],[x,M]],curve:W.curveBundle,options:{vertical:!1,curvature:.4},arrow:{color:"steelblue",marker:"M-5,-10 L-5,10 L20,0 z"}}),m.use(It),m.use(Et,{margin:{x:200,y:50},depth:0});const v=new d.Engine("tuna-mayonnaise@0.0.1");u.forEach(p=>{m.register(p),v.register(p)});const f=()=>(document.getElementsByClassName("rightClick")[0].style.display="block",null),g=await fetch("/tuna-configuration").then(p=>p.ok?p.json():f()).catch(()=>f());if(g!==null)await m.fromJSON(g),P(()=>import("./vendor.1ab47a0d.js").then(function(p){return p.q}),[]).then(({toast:p})=>p.success("RESUMED :)"));else{const p=await u[0].createNode();p.position=[1e3,200],m.addNode(p)}m.on("showcontextmenu",()=>(document.getElementsByClassName("rightClick")[0].style.display="none",!0)),m.on("process nodecreated noderemoved connectioncreated connectionremoved",async()=>{document.querySelectorAll(".editorTextarea").forEach(p=>{p.addEventListener("wheel",y=>{N()&&(p.parentElement.parentElement.scrollTop+=y.deltaY)})}),await v.abort(),await v.process(m.toJSON())}),m.view.resize(),m.trigger("process"),Ot.zoomAt(m,m.nodes)}const le=()=>h("div",{className:"App",children:[l(Ft,{}),l("img",{className:"rightClick",src:"./right-click.svg",width:"200",height:"200",alt:"RightClick for Menu",style:{display:"none",position:"absolute",top:"25%",left:"25%",pointerEvents:"none"}}),l("div",{style:{width:"100vh",height:"100vh"},ref:C=>C&&ie(C)})]});mt.setAppElement("#root");const ce=document.getElementById("root");jt.render(l(le,{}),ce);
