var ft=Object.defineProperty;var yt=(f,t,s)=>t in f?ft(f,t,{enumerable:!0,configurable:!0,writable:!0,value:s}):f[t]=s;var w=(f,t,s)=>(yt(f,typeof t!="symbol"?t+"":t,s),s);import{r as j,u as H,j as l,_ as q,a as Ct,p as P,i as d,s as kt,N as $,b as m,S as O,C as _,F as J,H as wt,M as mt,R as dt,c as St,d as Nt,e as bt,f as vt,g as xt,k as W,l as Et,A as It,m as Ot,n as jt,T as Ft}from"./vendor.7bd79a26.js";const Tt=function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))e(a);new MutationObserver(a=>{for(const o of a)if(o.type==="childList")for(const r of o.addedNodes)r.tagName==="LINK"&&r.rel==="modulepreload"&&e(r)}).observe(document,{childList:!0,subtree:!0});function s(a){const o={};return a.integrity&&(o.integrity=a.integrity),a.referrerpolicy&&(o.referrerPolicy=a.referrerpolicy),a.crossorigin==="use-credentials"?o.credentials="include":a.crossorigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function e(a){if(a.ep)return;a.ep=!0;const o=s(a);fetch(a.href,o)}};Tt();const Mt="modulepreload",ht={},Pt="./",T=function(t,s){return!s||s.length===0?t():Promise.all(s.map(e=>{if(e=`${Pt}${e}`,e in ht)return;ht[e]=!0;const a=e.endsWith(".css"),o=a?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${e}"]${o}`))return;const r=document.createElement("link");if(r.rel=a?"stylesheet":Mt,a||(r.as="script",r.crossOrigin=""),r.href=e,document.head.appendChild(r),a)return new Promise((n,i)=>{r.addEventListener("load",n),r.addEventListener("error",()=>i(new Error(`Unable to preload CSS for ${e}`)))})})).then(()=>t())};const _t=({value:f,onChange:t})=>{const[s,e]=j.exports.useState(f),[a,o]=j.exports.useState(!1),[r,n]=j.exports.useState(null);return H(()=>{r!==null&&(T(()=>import("./vendor.7bd79a26.js").then(function(i){return i.q}),[]).then(({toast:i})=>i.error(r)),n(null))},1e4),l(q,{value:s,onValueChange:i=>{try{Ct.exports.parse(i),o(!1),n(null)}catch(p){n(p.message),o(!0)}e(i),t(i)},highlight:i=>P.exports.highlight(i,P.exports.languages.json),padding:10,style:{fontFamily:'"Fira code", "Fira Mono", monospace',fontSize:12,background:a?"rgba(255, 0, 80, 0.7)":"#FFF",maxWidth:"300px"}})},Z=class extends d.Control{constructor(t,s,e,a=!1){super(s);this.emitter=t,this.key=s,this.component=Z.component;const o=e.data[s]||'{"name": "value"}';e.data[s]=o,e.data.output=o,this.props={readonly:a,value:o,onChange:r=>{this.setValue(r),this.emitter.trigger("process")}}}setValue(t){this.props.value=t,this.putData(this.key,t),this.putData("output",t),this.update()}};let V=Z;w(V,"component",({value:t,onChange:s})=>l("div",{ref:e=>e&&e.addEventListener("pointerdown",a=>a.stopPropagation()),children:l(_t,{value:t,onChange:e=>s(e)})}));class Dt extends d.Component{constructor(t){super("JSON");w(this,"path",["New"]);this.socket=t}builder(t){const s=new d.Output("json","JSON",this.socket);return t.addControl(new V(this.editor,"json",t)).addOutput(s)}worker(t,s,e){e.json=t.data.json}}const Lt=({value:f,onChange:t})=>{const[s,e]=j.exports.useState(f);return l("div",{className:"hasScrollbar",style:{overflowY:"auto",maxHeight:"500px"},children:l(q,{textareaClassName:"editorTextarea",preClassName:"line-numbers",value:s,onValueChange:a=>{e(a),t(a)},highlight:a=>P.exports.highlight(a,P.exports.languages.xml).split(`
`).map(o=>`<span class="container_editor_line_number">${o}</span>`).join(`
`),padding:10,style:{fontFamily:'"Fira code", "Fira Mono", monospace',fontSize:12,background:"#FFF",maxWidth:"800px"}})})},tt=class extends d.Control{constructor(t,s,e,a=!1){super(s);this.emitter=t,this.key=s,this.component=tt.component;const o=e.data[s]||`<!DOCTYPE html>
    <html lang="en">
      <head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <meta http-equiv="X-UA-Compatible" content="ie=edge">
        <title>REPLACE HERE!</title>
        <!-- <link rel="stylesheet" href="style.css"> -->
      </head>
      <body>
      <!-- <script src="index.js"><\/script> -->
      </body>
    </html>`;e.data[s]=o,e.data.output=o,this.props={readonly:a,value:o,onChange:r=>{this.setValue(r),this.emitter.trigger("process")}}}setValue(t){this.props.value=t,this.putData(this.key,t),this.putData("output",t),this.update()}};let K=tt;w(K,"component",({value:t,onChange:s})=>l("div",{ref:e=>e&&e.addEventListener("pointerdown",a=>a.stopPropagation()),children:l(Lt,{value:t,onChange:e=>s(e)})}));class $t extends d.Component{constructor(t){super("HTML");w(this,"path",["New"]);this.socket=t}builder(t){const s=new d.Output("html","HTML",this.socket);return t.addControl(new K(this.editor,"html",t)).addOutput(s)}worker(t,s,e){e.html=t.data.html}}const Jt=({value:f,onChange:t})=>{const[s,e]=j.exports.useState(f),[a,o]=j.exports.useState(!1),[r,n]=j.exports.useState(null);return H(()=>{r!==null&&(T(()=>import("./vendor.7bd79a26.js").then(function(i){return i.q}),[]).then(({toast:i})=>i.error(r)),n(null))},1e4),l(q,{value:s,onValueChange:i=>{try{kt.exports.parse(i),o(!1),n(null)}catch(p){n(p.message),o(!0)}e(i),t(i)},highlight:i=>P.exports.highlight(i,P.exports.languages.sql),padding:10,style:{fontFamily:'"Fira code", "Fira Mono", monospace',fontSize:12,background:a?"rgba(255, 0, 80, 0.7)":"#FFF",maxWidth:"300px"}})},et=class extends d.Control{constructor(t,s,e,a=!1){super(s);this.emitter=t,this.key=s,this.component=et.component;const o=e.data[s]||"SELECT * FROM users";e.data[s]=o,e.data.output=o,this.props={readonly:a,value:o,onChange:r=>{this.setValue(r),this.emitter.trigger("process")}}}setValue(t){this.props.value=t,this.putData(this.key,t),this.putData("output",t),this.update()}};let U=et;w(U,"component",({value:t,onChange:s})=>l("div",{ref:e=>e&&e.addEventListener("pointerdown",a=>a.stopPropagation()),children:l(Jt,{value:t,onChange:e=>s(e)})}));class At extends d.Component{constructor(t){super("SQL");w(this,"path",["New"]);this.socket=t}builder(t){const s=new d.Output("sql","SQL",this.socket);return t.addControl(new U(this.editor,"sql",t)).addOutput(s)}worker(t,s,e){e.sql=t.data.sql}}class Rt extends ${render(){const{bindSocket:t,bindControl:s}=this.props,{outputs:e,controls:a,inputs:o,selected:r}=this.state;return m("div",{className:`node ${r}`,style:{background:"grey"},children:[l("div",{className:"title",children:"Template"}),e.map(n=>m("div",{className:"output",children:[l("div",{className:"output-title",children:n.name}),l(O,{type:"output",socket:n.socket,io:n,innerRef:t})]},n.key)),a.map(n=>l(_,{className:"control",control:n,innerRef:s},n.key)),o.map(n=>m("div",{className:"input",children:[l(O,{type:"input",socket:n.socket,io:n,innerRef:t}),l("div",{className:"input-title",children:n.name})]},n.key))]})}}const st=class extends d.Control{constructor(t,s,e,a=!1){super(s);this.emitter=t,this.keys=[],this.component=st.component,this.props={readonly:a,value:"",onChange:()=>{}},e.data.output=""}setValue(t,s,e){this.props.value=s,this.putData("output",s),this.putData("contentType",e),Object.entries(t).forEach(([a,o])=>{o[0]&&this.putData(a,o[0])}),this.update()}};let Q=st;w(Q,"component",({value:t,onChange:s})=>m(J,{children:[l("label",{style:{color:"white",display:"block",textAlign:"left"},children:"Preview"}),l("textarea",{value:t,rows:10,ref:e=>e&&e.addEventListener("pointerdown",a=>a.stopPropagation()),onChange:e=>s(String(e.target.value)),disabled:!0})]}));const qt=window.pug;class Vt extends d.Component{constructor(t,s,e){super("Template");w(this,"path",["New"]);this.data.component=Rt,this.dataSocket=t,this.templateSocket=s,this.htmlSocket=e}builder(t){const s=new d.Input("template","TemplateEngine",this.templateSocket),e=new d.Input("json","Data (JSON)",this.dataSocket),a=new d.Output("html","HTML",this.htmlSocket);return e.addControl(new V(this.editor,"json",t)),t.addInput(s).addInput(e).addControl(new Q(this.editor,"template",t,!0)).addOutput(a)}worker(t,s,e){const a=s.json.length?s.json[0]:t.data.json,o=t.inputs.template.connections.filter(n=>(n==null?void 0:n.output)==="hbs"||(n==null?void 0:n.output)==="pug"),r=(()=>{var p;if(o.length===0)return"No TemplateEngine detected...";const n=o[0].output,i=(p=s.template)!=null&&p.length?s.template[0]:t.data.json;return n==="pug"?qt.render(i,JSON.parse(a)):n==="hbs"?wt.compile(i)(JSON.parse(a)):"Unknown TemplateEngine detected..."})();this.editor.nodes.find(n=>n.id===t.id).controls.get("template").setValue(s,r,"text/html; charset=utf-8"),e.html=r}}const Bt=({value:f,onChange:t})=>{const[s,e]=j.exports.useState(f),[a,o]=j.exports.useState(!1),[r,n]=j.exports.useState(null);return H(()=>{r!==null&&(T(()=>import("./vendor.7bd79a26.js").then(function(i){return i.q}),[]).then(({toast:i})=>i.error(r)),n(null))},1e4),l("div",{className:"hasScrollbar",style:{overflowY:"auto",maxHeight:"500px"},children:l(q,{textareaClassName:"editorTextarea",preClassName:"line-numbers",value:s,onValueChange:i=>{T(()=>import("./vendor.7bd79a26.js").then(function(p){return p.h}),[]).then(p=>{p.precompile(i),o(!1),n(null)}).catch(p=>{n(p.message),o(!0)}),e(i),t(i)},highlight:i=>P.exports.highlight(i,P.exports.languages.handlebars).split(`
`).map(p=>`<span class="container_editor_line_number">${p}</span>`).join(`
`),padding:10,style:{fontFamily:'"Fira code", "Fira Mono", monospace',fontSize:12,background:a?"rgba(255, 0, 80, 0.7)":"#FFF",maxWidth:"800px"}})})},nt=class extends d.Control{constructor(t,s,e,a=!1){super(s);this.emitter=t,this.key=s,this.component=nt.component;const o=e.data[s]||"<div>{{name}}</div>";e.data[s]=o,e.data.output=o,this.props={readonly:a,value:o,onChange:r=>{this.setValue(r),this.emitter.trigger("process")}}}setValue(t){this.props.value=t,this.putData(this.key,t),this.putData("output",t),this.update()}};let Y=nt;w(Y,"component",({value:t,onChange:s})=>l("div",{ref:e=>e&&e.addEventListener("pointerdown",a=>a.stopPropagation()),children:l(Bt,{value:t,onChange:e=>s(e)})}));class Ht extends d.Component{constructor(t){super("Handlebars");w(this,"path",["New"]);this.socket=t}builder(t){const s=new d.Output("hbs","Handlebars",this.socket);return t.addControl(new Y(this.editor,"hbs",t)).addOutput(s)}worker(t,s,e){e.hbs=t.data.hbs}}const Wt=window.pug,Kt=({value:f,onChange:t})=>{const[s,e]=j.exports.useState(f),[a,o]=j.exports.useState(!1),[r,n]=j.exports.useState(null);return H(()=>{r!==null&&(T(()=>import("./vendor.7bd79a26.js").then(function(i){return i.q}),[]).then(({toast:i})=>i.error(r)),n(null))},1e4),l("div",{className:"hasScrollbar",style:{overflowY:"auto",maxHeight:"500px"},children:l(q,{textareaClassName:"editorTextarea",preClassName:"line-numbers",value:s,onValueChange:i=>{try{Wt.compile(i),o(!1),n(null)}catch(p){n(p.message),o(!0)}e(i),t(i)},highlight:i=>P.exports.highlight(i,P.exports.languages.pug).split(`
`).map(p=>`<span class="container_editor_line_number">${p}</span>`).join(`
`),padding:10,style:{fontFamily:'"Fira code", "Fira Mono", monospace',fontSize:12,background:a?"rgba(255, 0, 80, 0.7)":"#FFF",maxWidth:"800px"}})})},at=class extends d.Control{constructor(t,s,e,a=!1){super(s);this.emitter=t,this.key=s,this.component=at.component;const o=e.data[s]||"div #{name}";e.data[s]=o,e.data.output=o,this.props={readonly:a,value:o,onChange:r=>{this.setValue(r),this.emitter.trigger("process")}}}setValue(t){this.props.value=t,this.putData(this.key,t),this.putData("output",t),this.update()}};let z=at;w(z,"component",({value:t,onChange:s})=>l("div",{ref:e=>e&&e.addEventListener("pointerdown",a=>a.stopPropagation()),children:l(Kt,{value:t,onChange:e=>s(e)})}));class Ut extends d.Component{constructor(t){super("Pug");w(this,"path",["New"]);this.socket=t}builder(t){const s=new d.Output("pug","Pug",this.socket);return t.addControl(new z(this.editor,"pug",t)).addOutput(s)}worker(t,s,e){e.pug=t.data.pug}}class Qt extends ${render(){const{bindSocket:t,bindControl:s}=this.props,{outputs:e,controls:a,inputs:o,selected:r}=this.state;return m("div",{className:`node ${r}`,style:{background:"grey"},children:[l("div",{className:"title",children:"Endpoint"}),e.map(n=>m("div",{className:"output",children:[l("div",{className:"output-title",children:n.name}),l(O,{type:"output",socket:n.socket,io:n,innerRef:t})]},n.key)),a.map(n=>l(_,{className:"control",control:n,innerRef:s},n.key)),o.map(n=>m("div",{className:"input",children:[l(O,{type:"input",socket:n.socket,io:n,innerRef:t}),l("div",{className:"input-title",children:n.name})]},n.key))]})}}const ot=class extends d.Control{constructor(t,s,e,a=!1){super(s);this.emitter=t,this.component=ot.component,this.props={readonly:a,value:"",contentType:"",onChange:()=>{}},e.data.output=""}setValue(t,s,e,a,o){this.props.value=s,this.props.contentType=e,this.putData("enabledFlag",a),this.putData("output",s),this.putData("contentType",e),this.putData("path",o),Object.entries(t).forEach(([r,n])=>{n[0]&&this.putData(r,n[0])}),this.update()}};let B=ot;w(B,"component",({value:t,contentType:s,onChange:e})=>m(J,{children:[l("label",{style:{color:"white",display:"block",textAlign:"left"},children:"Preview"}),s==="text/html; charset=utf-8"?l("div",{className:"hasScrollbar",style:{backgroundColor:"white",overflowY:"auto",maxHeight:"500px"},dangerouslySetInnerHTML:{__html:t}}):l("textarea",{value:t,rows:10,ref:a=>a&&a.addEventListener("pointerdown",o=>o.stopPropagation()),onChange:a=>e(String(a.target.value)),disabled:!0})]}));const rt=class extends d.Control{constructor(t,s,e,a=!1,o=""){super(s);this.emitter=t,this.key=s,this.component=rt.component;const r=e.data[s]||!1;e.data[s]=r,e.data.output=r,this.props={readonly:a,checked:r,title:o,onChange:n=>{this.setValue(!!n),this.emitter.trigger("process")}}}setValue(t){this.props.checked=t,this.putData(this.key,t),this.putData("output",t),this.update()}};let F=rt;w(F,"component",({checked:t,onChange:s,title:e,id:a=new Date().getTime()})=>m(J,{children:[e&&l("div",{style:{color:"white",textAlign:"left",marginBottom:"5px"},children:e}),m("div",{className:"switchArea",children:[l("input",{type:"checkbox",id:a,checked:t,ref:o=>o&&o.addEventListener("pointerdown",r=>r.stopPropagation()),onChange:o=>s(+o.target.checked)}),l("label",{htmlFor:a,children:l("span",{})}),l("div",{className:"swImg"})]})]}));const it=class extends d.Control{constructor(t,s,e,a=!1,o="",r=""){super(s);this.emitter=t,this.key=s,this.component=it.component;const n=e.data[s]||"";e.data[s]=n,e.data.output=n,this.props={readonly:a,value:n,title:o,placeHolder:r,onChange:i=>{this.setValue(i),this.emitter.trigger("process")}}}setValue(t){this.props.value=t,this.putData(this.key,t),this.putData("output",t),this.update()}};let E=it;w(E,"component",({value:t,onChange:s,title:e,placeHolder:a})=>m(J,{children:[e&&l("label",{style:{color:"white",display:"block",textAlign:"left"},children:e}),l("input",{type:"text",value:t,placeholder:a,ref:o=>o&&o.addEventListener("pointerdown",r=>r.stopPropagation()),onChange:o=>s(String(o.target.value))})]}));const lt=class extends d.Control{constructor(t,s,e,a=!1,o="",r="",n=!1){super(s);this.emitter=t,this.key=s,this.component=lt.component;const i=e.data[s]||"/foo";e.data[s]=i,e.data.output=i,this.props={readonly:a,value:i,title:o,placeHolder:r,warn:n,onChange:p=>{p===""?this.props.warn=!0:p==="/metrics"||p==="/health"?(this.props.warn=!0,T(()=>import("./vendor.7bd79a26.js").then(function(y){return y.q}),[]).then(({toast:y})=>y.error("this Path is reserved, use another Path."))):this.props.warn=!1,this.setValue(p),this.emitter.trigger("process")}}}setValue(t){this.props.value=t,this.putData(this.key,t),this.putData("output",t),this.update()}};let R=lt;w(R,"component",({value:t,onChange:s,title:e,placeHolder:a,warn:o})=>m(J,{children:[e&&l("label",{style:{color:"white",display:"block",textAlign:"left"},children:e}),l("input",{type:"text",value:t,placeholder:a,ref:r=>r&&r.addEventListener("pointerdown",n=>n.stopPropagation()),onChange:r=>s(String(r.target.value)),style:{background:o?"rgba(255, 0, 80, 0.7)":"#FFF"}})]}));const ct=class extends d.Control{constructor(t,s,e,a=!1,o="",r=0,n=!1,i=!1){super(s);this.emitter=t,this.key=s,this.component=ct.component;const p=e.data[s]||r;e.data[s]=p,e.data.output=p,this.props={readonly:a,value:p,title:o,disabled:n,hidden:i,onChange:y=>{this.setValue(y),this.emitter.trigger("process")}}}setValue(t,s=!1,e=!1){this.props.value=t,this.props.disabled=s,this.props.hidden=e,this.putData(this.key,t),this.putData("output",t),this.update()}};let M=ct;w(M,"component",({value:t,onChange:s,title:e,disabled:a,hidden:o})=>m("div",{style:{display:o?"none":"block"},children:[e&&l("label",{style:{color:"white",display:"block",textAlign:"left"},children:e}),l("input",{type:"number",value:t,ref:r=>r&&r.addEventListener("pointerdown",n=>n.stopPropagation()),onChange:r=>s(+r.target.value),disabled:a})]}));const pt=class extends d.Control{constructor(t,s,e,a=!1,o="",r=[],n=!1,i=!1){super(s);this.emitter=t,this.key=s,this.component=pt.component;const p=e.data[s]||r[0];e.data[s]=p,e.data.output=p,this.props={readonly:a,value:p,title:o,values:r,disabled:n,hidden:i,onChange:y=>{this.setValue(y),this.emitter.trigger("process")}}}setValue(t,s=!1,e=!1){this.props.value=t,this.props.disabled=s,this.props.hidden=e,this.putData(this.key,t),this.putData("output",t),this.update()}};let D=pt;w(D,"component",({title:t,value:s,values:e,onChange:a,disabled:o,hidden:r})=>m("div",{style:{display:r?"none":"block"},children:[t&&l("label",{style:{color:"white",display:"block",textAlign:"left"},children:t}),l("select",{style:{width:"100%"},value:s,ref:n=>n&&n.addEventListener("pointerdown",i=>i.stopPropagation()),onChange:n=>a(String(n.target.value)),disabled:o,children:e.map((n,i)=>l("option",{value:n,children:n},`${n}_${i}`))})]}));class Yt extends d.Component{constructor(t){super("Endpoint");w(this,"path",["New"]);this.data.component=Qt,this.stringSocket=t}builder(t){var e;t.data.enabledFlag=(e=t.data.enabledFlag)!=null?e:!0;const s=new d.Input("content","Content (JSON/HTML)",this.stringSocket);return s.addControl(new E(this.editor,"content",t)),t.addInput(s).addControl(new B(this.editor,"endpoint",t,!0)).addControl(new F(this.editor,"enabledFlag",t,!1,"Enabled")).addControl(new D(this.editor,"method",t,!1,"Method",["GET","POST","PUT","PATCH","DELETE","OPTIONS"])).addControl(new R(this.editor,"path",t,!1,"Path","/foo")).addControl(new F(this.editor,"botblockerEnableFlag",t,!1,"BotBlocker")).addControl(new F(this.editor,"ratelimitEnableFlag",t,!1,"RateLimit")).addControl(new D(this.editor,"ratelimitUnit",t,!1,"Unit",["any","ip"])).addControl(new M(this.editor,"ratelimitLimit",t,!1,"Limit",30)).addControl(new M(this.editor,"ratelimitBurst",t,!1,"Burst",0)).addControl(new M(this.editor,"ratelimitExpireSecond",t,!1,"ExpireSecond",60))}worker(t,s){const e=s.content.length?s.content[0]:"Rendering...",a=(n=>{if(n){if(n.output==="html")return"text/html; charset=utf-8";if(n.output==="json")return"application/json; charset=utf-8"}return"text/plain; charset=utf-8"})(t.inputs.content.connections[0]),{enabledFlag:o}=t.data,{path:r}=t.data;this.editor.nodes.find(n=>n.id===t.id).controls.get("endpoint").setValue(s,e,a,o,r),["ratelimitUnit","ratelimitLimit","ratelimitBurst","ratelimitExpireSecond"].forEach(n=>{this.editor.nodes.find(i=>i.id===t.id).controls.get(n).setValue(t.data[n],!t.data.ratelimitEnableFlag,!t.data.ratelimitEnableFlag)})}}class zt extends ${render(){const{bindSocket:t,bindControl:s}=this.props,{outputs:e,controls:a,inputs:o,selected:r}=this.state;return m("div",{className:`node ${r}`,style:{background:"grey"},children:[l("div",{className:"title",children:"EndpointWithError"}),e.map(n=>m("div",{className:"output",children:[l("div",{className:"output-title",children:n.name}),l(O,{type:"output",socket:n.socket,io:n,innerRef:t})]},n.key)),a.map(n=>l(_,{className:"control",control:n,innerRef:s},n.key)),o.map(n=>m("div",{className:"input",children:[l(O,{type:"input",socket:n.socket,io:n,innerRef:t}),l("div",{className:"input-title",children:n.name})]},n.key))]})}}class Gt extends d.Component{constructor(t,s){super("EndpointWithError");w(this,"path",["New"]);this.data.component=zt,this.stringSocket=t,this.errorSocket=s}builder(t){var a;t.data.enabledFlag=(a=t.data.enabledFlag)!=null?a:!0;const s=new d.Input("content","Content (JSON/HTML)",this.stringSocket);s.addControl(new E(this.editor,"content",t));const e=new d.Input("error","Error (JSON/HTML)",this.errorSocket);return e.addControl(new E(this.editor,"error",t)),t.addInput(s).addInput(e).addControl(new B(this.editor,"endpoint",t,!0)).addControl(new F(this.editor,"enabledFlag",t,!1,"Enabled")).addControl(new D(this.editor,"method",t,!1,"Method",["GET","POST","PUT","PATCH","DELETE","OPTIONS"])).addControl(new R(this.editor,"path",t,!1,"Path","/foo")).addControl(new F(this.editor,"botblockerEnableFlag",t,!1,"BotBlocker")).addControl(new F(this.editor,"ratelimitEnableFlag",t,!1,"RateLimit")).addControl(new D(this.editor,"ratelimitUnit",t,!1,"Unit",["any","ip"])).addControl(new M(this.editor,"ratelimitLimit",t,!1,"Limit",30)).addControl(new M(this.editor,"ratelimitBurst",t,!1,"Burst",0)).addControl(new M(this.editor,"ratelimitExpireSecond",t,!1,"ExpireSecond",60))}worker(t,s){const e=s.content.length?s.content[0]:"Rendering...",a=(n=>{if(n){if(n.output==="html")return"text/html; charset=utf-8";if(n.output==="json")return"application/json; charset=utf-8"}return"text/plain; charset=utf-8"})(t.inputs.content.connections[0]),{enabledFlag:o}=t.data,{path:r}=t.data;this.editor.nodes.find(n=>n.id===t.id).controls.get("endpoint").setValue(s,e,a,o,r),["ratelimitUnit","ratelimitLimit","ratelimitBurst","ratelimitExpireSecond"].forEach(n=>{this.editor.nodes.find(i=>i.id===t.id).controls.get(n).setValue(t.data[n],!t.data.ratelimitEnableFlag,!t.data.ratelimitEnableFlag)})}}class Xt extends ${render(){const{bindSocket:t,bindControl:s}=this.props,{outputs:e,controls:a,inputs:o,selected:r}=this.state;return m("div",{className:`node ${r}`,style:{background:"grey"},children:[l("div",{className:"title",children:"JSONManager"}),e.map(n=>m("div",{className:"output",children:[l("div",{className:"output-title",children:n.name}),l(O,{type:"output",socket:n.socket,io:n,innerRef:t})]},n.key)),a.map(n=>l(_,{className:"control",control:n,innerRef:s},n.key)),o.map(n=>m("div",{className:"input jsonManagerInput",children:[l(O,{type:"input",socket:n.socket,io:n,innerRef:t}),l("div",{className:"input-title",children:n.name})]},n.key))]})}}const ut=class extends d.Control{constructor(t,s,e,a=!1){super(s);this.emitter=t,this.component=ut.component,this.props={readonly:a,inputs:[],inputIds:[],outputs:e.data.output?JSON.parse(e.data.output):[],state:{pointerPos:{x:0,y:0},drag:{},selectedElement:{}},isDroppable:!1,onPointerOver:()=>{this.props.isDroppable=!0},onPointerOut:()=>{this.props.isDroppable=!1},onPointerDown:o=>{const r=o.currentTarget;this.props.state.pointerPos.x=o.clientX,this.props.state.pointerPos.y=o.clientY,this.props.state.selectedElement=r;const n=r.cloneNode(!0),i=n.style;i.transition="",i.pointerEvents="none",i.display="none",i.position="absolute";const p=10,y=/^.*scale\((.*)\)$/,I=document.getElementsByClassName("minimap")[0].previousElementSibling.style.transform.match(y)[1],b=(r.getBoundingClientRect().left-r.closest(".jsonManagerCtrl").getBoundingClientRect().left)/I+p;i.left=`${b}px`,r.after(n);const{left:N,top:g}=r.getBoundingClientRect(),C={x:N,y:g};this.props.state.drag={dragElement:n,position:C},r.classList.remove("jsonManagerCtrlInputKeyHover");const v=r.closest(".node");v.style.cursor="grabbing",v.addEventListener("pointerup",this.props.onPointerUp),v.addEventListener("pointermove",this.props.onPointerMove)},onPointerMove:o=>{o.stopPropagation();const r=/^.*scale\((.*)\)$/,i=document.getElementsByClassName("minimap")[0].previousElementSibling.style.transform.match(r)[1],{clientX:p,clientY:y}=o,{drag:h,pointerPos:I}=this.props.state,b=(p-I.x)/i,N=(y-I.y)/i,g=h.dragElement.style;g.display="inline-block",g.zIndex="100",g.transform=`translate(${b}px,${N}px)`},onPointerUp:()=>{const{drag:o,selectedElement:r}=this.props.state;this.props.state.drag=null,r.classList.add("jsonManagerCtrlInputKeyHover");const n=r.closest(".node");if(n.style.cursor="pointer",n.removeEventListener("pointerup",this.props.onPointerUp),n.removeEventListener("pointermove",this.props.onPointerMove),this.props.isDroppable){const i=parseInt(r.dataset.idx,10),p=parseInt(r.dataset.nodeid,10),y=r.innerText;if(r.dataset.type!=="func")this.props.outputs.filter(h=>h.key===y).length===1?this.props.outputs=this.props.outputs.map(h=>h.key===y?{srcId:p,srcIds:"",src:i,key:h.key,value:JSON.stringify(JSON.parse(this.props.inputs[i])[h.key])}:h):this.props.outputs.push({srcId:p,srcIds:"",src:i,key:y,value:JSON.stringify(JSON.parse(this.props.inputs[i])[y])});else{const{params:h}=this.props.outputFunctions[i],I=this.props.functions.filter(S=>S.name===this.props.outputFunctions[i].func)[0],{paramCount:b,logic:N}=I,{p0:g,p0Id:C}=(()=>{if(h[0].startsWith("inputs[")){const x=/^inputs\[(\d+)\](([^.]?)|\.(.*))$/.exec(h[0]),L=x[1],A=x[4];return A?{p0:JSON.parse(this.props.inputs[L])[A],p0Id:L}:{p0:JSON.parse(this.props.inputs[L]),p0Id:L}}return{p0:h[0],p0Id:null}})(),{p1:v,p1Id:c}=(()=>{if(b===2&&h[1].startsWith("inputs[")){const x=/^inputs\[(\d+)\](([^.]?)|\.(.*))$/.exec(h[1]),L=x[1],A=x[4];return A?{p1:JSON.parse(this.props.inputs[L])[A],p1Id:L}:{p1:JSON.parse(this.props.inputs[L]),p1Id:L}}return{p1:h[1],p1Id:null}})(),u=b===1?N(g):N(g,v),k=(()=>b===1?C!==null?`${C}:${parseInt(document.querySelectorAll(`.jsonManagerCtrlInputKey[data-idx='${C}']`)[0].dataset.nodeid,10)}`:"":C==null&&c==null?"":C==null?`${c}:${parseInt(document.querySelectorAll(`.jsonManagerCtrlInputKey[data-idx='${c}']`)[0].dataset.nodeid,10)}`:`${C}:${parseInt(document.querySelectorAll(`.jsonManagerCtrlInputKey[data-idx='${C}']`)[0].dataset.nodeid,10)}`)();this.props.outputs.filter(S=>S.key===y).length===1?this.props.outputs=this.props.outputs.map(S=>S.key===y?{srcId:-1,srcIds:k,src:(i+1)*-1,key:S.key,value:JSON.stringify(u)}:S):this.props.outputs.push({srcId:-1,srcIds:k,src:(i+1)*-1,key:y,value:JSON.stringify(u)})}this.putData("output",JSON.stringify(this.props.outputs)),this.update(),this.emitter.trigger("process")}o.dragElement.remove()},onClickCloseBtn:o=>{const r=o.currentTarget;this.props.outputs=this.props.outputs.reduce((n,i)=>i.key===r.dataset.key?n:[...n,i],[]),this.putData("output",JSON.stringify(this.props.outputs)),this.update(),this.emitter.trigger("process")},isModalOpen:!1,setModalOpen:o=>{this.props.isModalOpen=o,this.update(),this.emitter.trigger("process")},outputFunctions:!(Array.isArray(e.data.outputFunctions)&&e.data.outputFunctions.length===0)&&e.data.outputFunctions?JSON.parse(e.data.outputFunctions):[],functions:[{name:"Naming",paramCount:1,symbol:null,logic:o=>o}],onClickAddBtn:o=>{const r=o.currentTarget.previousElementSibling.value;r!==""&&(this.props.outputFunctions.push({func:r,name:"",params:[],warn:!1}),this.putData("outputFunctions",JSON.stringify(this.props.outputFunctions)),this.update(),this.emitter.trigger("process"))},onClickRemoveBtn:o=>{const r=parseInt(o.currentTarget.dataset.idx,10),{name:n}=this.props.outputFunctions[r];this.props.outputs=this.props.outputs.filter(i=>i.key!==n),this.props.outputFunctions=this.props.outputFunctions.filter((i,p)=>p!==r),this.putData("outputFunctions",JSON.stringify(this.props.outputFunctions)),this.update(),this.emitter.trigger("process")},onChangeModalFunc:o=>{const r=parseInt(o.currentTarget.dataset.idx,10);this.props.outputFunctions.filter(n=>n.name===o.target.value).length===1?this.props.outputFunctions[r].warn=!0:this.props.outputFunctions[r].warn=!1,this.props.outputFunctions[r].name=o.target.value,this.putData("outputFunctions",JSON.stringify(this.props.outputFunctions)),this.update(),this.emitter.trigger("process")},onChangeModalFuncParams:o=>{const r=parseInt(o.currentTarget.dataset.idx,10),n=parseInt(o.currentTarget.dataset.paramsIdx,10);if(n===2&&this.props.outputFunctions[r].params.length<2&&(this.props.outputFunctions[r].params[0]=null),this.props.outputFunctions[r].params[n]=o.target.value,this.putData("outputFunctions",JSON.stringify(this.props.outputFunctions)),this.props.outputFunctions[r].name){const i=this.props.outputFunctions[r].name,{params:p}=this.props.outputFunctions[r],y=this.props.functions.filter(b=>b.name===this.props.outputFunctions[r].func)[0],{paramCount:h,logic:I}=y;if(h===1||p[0]){const{p0:b,p0Id:N}=(()=>{if(p[0].startsWith("inputs[")){const k=/^inputs\[(\d+)\](([^.]?)|\.(.*))$/.exec(p[0]),S=k[1],x=k[4];return x?{p0:JSON.parse(this.props.inputs[S])[x],p0Id:S}:{p0:JSON.parse(this.props.inputs[S]),p0Id:S}}return{p0:p[0],p0Id:null}})(),{p1:g,p1Id:C}=(()=>{if(h===2&&p[1].startsWith("inputs[")){const k=/^inputs\[(\d+)\](([^.]?)|\.(.*))$/.exec(p[1]),S=k[1],x=k[4];return x?{p1:JSON.parse(this.props.inputs[S])[x],p1Id:S}:{p1:JSON.parse(this.props.inputs[S]),p1Id:S}}return{p1:p[1],p1Id:null}})(),v=h===1?I(b):I(b,g),c=(()=>h===1?N!==null?`${N}:${parseInt(document.querySelectorAll(`.jsonManagerCtrlInputKey[data-idx='${N}']`)[0].dataset.nodeid,10)}`:"":N==null&&C==null?"":N==null?`${C}:${parseInt(document.querySelectorAll(`.jsonManagerCtrlInputKey[data-idx='${C}']`)[0].dataset.nodeid,10)}`:`${N}:${parseInt(document.querySelectorAll(`.jsonManagerCtrlInputKey[data-idx='${N}']`)[0].dataset.nodeid,10)}`)();this.props.outputs.filter(u=>u.key===i).length===1&&(this.props.outputs=this.props.outputs.map(u=>u.key===i?{srcId:-1,srcIds:c,src:(r+1)*-1,key:u.key,value:JSON.stringify(v)}:u))}}this.update(),this.emitter.trigger("process")},textAreaRef:dt.createRef(),previewRef:dt.createRef()}}setValue(t,s){const e=t.inputs.content.connections.map(o=>o.node),{content:a}=s;this.props.inputs=a,this.props.inputIds=e,a.length===0&&(this.props.outputs=[],this.props.outputFunctions=[]),e.length>a.length?(this.props.outputs=[],this.props.outputFunctions=[]):(a.forEach((r,n)=>this.props.outputs=this.props.outputs.reduce((i,p)=>{if(p.src===n){const y=JSON.parse(r);return Object.keys(y).includes(p.key)?[...i,{srcId:p.srcId,srcIds:p.srcIds,src:p.src,key:p.key,value:JSON.stringify(y[p.key])}]:i}return[...i,p]},[])),this.props.outputFunctions.filter(r=>r.name&&r.params.reduce((n,i)=>n||i.startsWith("inputs["),!1)).length&&(this.props.outputFunctions.forEach((r,n)=>{try{const i=r.name,{params:p}=r,y=this.props.functions.filter(b=>b.name===r.func)[0],{paramCount:h,logic:I}=y;if(h===1||p[0]){const b=(()=>{if(p[0]!==void 0&&p[0].startsWith("inputs[")){const v=/^inputs\[(\d+)\](([^.]?)|\.(.*))$/.exec(p[0]),c=v[1],u=v[4],k=u?JSON.parse(this.props.inputs[c])[u]:JSON.parse(this.props.inputs[c]);if(k===void 0)throw Error;return k}return p[0]})(),N=(()=>{if(h===2&&p[1]!==void 0&&p[1].startsWith("inputs[")){const v=/^inputs\[(\d+)\](([^.]?)|\.(.*))$/.exec(p[1]),c=v[1],u=v[4],k=u?JSON.parse(this.props.inputs[c])[u]:JSON.parse(this.props.inputs[c]);if(k===void 0)throw Error;return k}return p[1]})(),g=h===1?I(b):I(b,N);this.props.outputs.filter(C=>C.key===i).length===1&&(this.props.outputs=this.props.outputs.map(C=>C.key===i?{srcId:C.srcId,srcIds:C.srcIds,src:C.src,key:C.key,value:JSON.stringify(g)}:C))}}catch{this.props.outputs=this.props.outputs.filter(p=>p.key!==this.props.outputFunctions[n].name),delete this.props.outputFunctions[n]}}),this.props.outputFunctions=this.props.outputFunctions.filter(r=>r!==void 0))),this.putData("output",JSON.stringify(this.props.outputs)),this.update()}};let G=ut;w(G,"component",({inputs:t,inputIds:s,outputs:e,onPointerDown:a,onPointerOver:o,onPointerOut:r,onClickCloseBtn:n,isModalOpen:i,setModalOpen:p,functions:y,onClickAddBtn:h,onChangeModalFunc:I,outputFunctions:b,onClickRemoveBtn:N,onChangeModalFuncParams:g,textAreaRef:C,previewRef:v})=>m("div",{className:"jsonManagerCtrl",children:[m(mt,{isOpen:i,style:{content:{padding:"0px"}},children:[m("div",{className:"jsonManagerModalTitle",children:[l("p",{style:{display:"inline-block",fontWeight:"600",fontSize:"18px"},children:"Functions"}),l("span",{role:"button",tabIndex:"0",className:"closeBtn",onClick:()=>p(!1)})]}),m("div",{className:"jsonManagerModalContent",children:[m("select",{style:{color:"#767676"},ref:c=>c&&c.addEventListener("pointerdown",u=>u.stopPropagation()),children:[l("option",{value:"",style:{display:"none"},children:"Select your function"}),y.map(c=>l("option",{value:c.name,children:c.name},c.name))]}),l("div",{role:"button",tabIndex:"0",className:"modalAddBtn",onClick:h,children:"Add"}),b.map((c,u)=>m("div",{className:"modalFunction",children:[m("p",{className:"modalFunctionTitle",children:[c.func,l("span",{role:"button",tabIndex:"0",className:"removeBtn",onClick:N,"data-idx":u})]}),m("div",{className:"modalFunctionKey",children:[l("p",{className:"modalFunctionKeyTitle",children:"name:"}),l("input",{type:"text",value:c.name,placeholder:"name to use output",ref:k=>{k&&k.addEventListener("pointerdown",S=>S.stopPropagation())},onChange:I,"data-idx":u,style:{background:c.warn?"rgba(255, 0, 80, 0.7)":"#FFF"}})]}),m("div",{className:"modalFunctionKey",children:[l("p",{className:"modalFunctionKeyTitle",children:"params: "}),l("div",{className:"modalFunctionContent",children:(()=>{const k=y.filter(S=>S.name===c.func)[0];return k.paramCount===1?l("input",{className:"modalFunctionContentInput",list:"inputs-datalist",name:`func-${u}_0`,placeholder:"Input or Select your param",onChange:g,"data-idx":u,"data-params-idx":0,value:c.params[0]?c.params[0]:""}):m(J,{children:[l("input",{className:"modalFunctionContentInput",list:"inputs-datalist",name:`func-${u}_0`,placeholder:"Input or Select your param",onChange:g,"data-idx":u,"data-params-idx":0,value:c.params[0]?c.params[0]:null}),l("span",{className:"modalFunctionContentSymbol",children:k.symbol}),l("input",{className:"modalFunctionContentInput",list:"inputs-datalist",name:`func-${u}_1`,placeholder:"Input or Select your param",onChange:g,"data-idx":u,"data-params-idx":1,value:c.params[1]?c.params[1]:null})]})})()})]})]},`modalFunction_${u}`)),l("datalist",{id:"inputs-datalist",children:t.map((c,u)=>{try{const k=JSON.parse(c);return(()=>[...Array.isArray(k)?[l("option",{value:`inputs[${u}]`,children:`inputs[${u}]`},`inputs[${u}]`)]:[],...Object.keys(k).map(x=>l("option",{value:`inputs[${u}].${x}`,children:`inputs[${u}].${x}`},`inputs[${u}].${x}`))])()}catch{return""}})})]})]}),m("div",{className:"jsonManagerCtrlInputs",children:[m("div",{className:"jsonManagerCtrlInput",children:[l("p",{className:"jsonManagerCtrlCategory",children:"Inputs"}),t.map((c,u)=>{try{const k=JSON.parse(c);return Array.isArray(k)?m("div",{className:"jsonManagerCtrlInputGroup",children:[m("p",{className:"jsonManagerCtrlInputTitle",children:["inputs[",u,"]"]}),l("p",{className:"jsonManagerCtrlInputKey","data-nodeid":s[u],children:"Array"})]},`jsonManagerCtrlInputGroup_${u}`):m("div",{className:"jsonManagerCtrlInputGroup",children:[m("p",{className:"jsonManagerCtrlInputTitle",children:["inputs[",u,"]"]}),Object.keys(k).map((S,x)=>l("p",{className:"jsonManagerCtrlInputKey jsonManagerCtrlInputKeyHover",onPointerDown:a,"data-idx":u,"data-nodeid":s[u],children:S},`jsonManagerCtrlInputKey_${x}`))]},`jsonManagerCtrlInputGroup_${u}`)}catch{return""}})]}),m("div",{className:"jsonManagerCtrlFunctions",children:[m("p",{className:"jsonManagerCtrlCategory",children:["Functions",l("span",{role:"button",tabIndex:"0",className:"addBtn",onClick:()=>p(!0)})]}),l("div",{className:"jsonManagerCtrlInputGroup",children:b.map((c,u)=>c.name!==""&&m("p",{className:"jsonManagerCtrlInputKey jsonManagerCtrlInputKeyHover",onPointerDown:a,"data-idx":u,"data-type":"func",children:[c.name,l("span",{role:"button",tabIndex:"0",className:"removeBtn",onClick:N,"data-idx":u})]},`jsonManagerCtrlInputKey_${u}_func`))})]})]}),l("div",{className:"jsonManagerCtrlHint",children:">>>"}),m("div",{className:"jsonManagerCtrlOutputs",children:[m("div",{className:"jsonManagerCtrlPreview",style:{height:C&&v&&C.current&&v.current?`${C.current.scrollHeight+v.current.scrollHeight}px`:"initial",maxHeight:"200px"},children:[l("p",{className:"jsonManagerCtrlCategory",ref:v,children:"Preview"}),l("textarea",{disabled:!0,ref:C,className:"jsonManagerCtrlPreviewArea hasScrollbar",value:e.length!==0?JSON.stringify(Object.fromEntries(e.map(c=>[c.key,c.value?JSON.parse(c.value):""])),null,2):""})]}),m("div",{className:"jsonManagerCtrlOutput",onPointerOver:o,onPointerOut:r,children:[l("p",{className:"jsonManagerCtrlCategory",children:"Outputs"}),l("div",{className:"jsonManagerCtrlOutputArea",children:e.map((c,u)=>m("p",{className:"jsonManagerCtrlOutputKey",children:[c.key,l("span",{role:"button",tabIndex:"0",className:"removeBtn",onClick:n,"data-key":c.key})]},`jsonManagerCtrlOutputKey_${u}`))})]})]})]}));class Zt extends d.Component{constructor(t){super("JSONManager");w(this,"path",["New"]);this.data.component=Xt,this.jsonSocket=t}builder(t){const s=new d.Input("content","JSONs",this.jsonSocket,!0),e=new d.Output("json","JSON",this.jsonSocket);return t.addInput(s).addControl(new G(this.editor,"jsonManager",t,!0)).addOutput(e)}worker(t,s,e){if(this.editor.nodes.find(a=>a.id===t.id).controls.get("jsonManager").setValue(t,s),t.data.output==="[]")e.json="";else if(t.data.output!==""){const a=JSON.parse(t.data.output).map(o=>[o.key,JSON.parse(o.value)]);e.json=JSON.stringify(Object.fromEntries(a))}e.outputFunctions=t.data.outputFunctions}}class X extends ${render(){const{node:t,bindSocket:s,bindControl:e}=this.props,{outputs:a,controls:o,inputs:r,selected:n}=this.state;return m("div",{className:`node ${n}`,style:{background:"grey"},children:[l("div",{className:"title",children:t.name}),a.map(i=>m("div",{className:"output",children:[l("div",{className:"output-title",children:i.name}),l(O,{type:"output",socket:i.socket,io:i,innerRef:s})]},i.key)),o.map(i=>l(_,{className:"control",control:i,innerRef:e},i.key)),r.map(i=>m("div",{className:"input",children:[l(O,{type:"input",socket:i.socket,io:i,innerRef:s}),!i.showControl()&&l("div",{className:"input-title",children:i.name}),i.showControl()&&l(_,{className:"input-control",control:i.control,innerRef:e})]},i.key))]})}}class te extends d.Component{constructor(t){super("API");w(this,"path",["New"]);this.data.component=X,this.jsonSocket=t}builder(t){const s=new d.Input("json","Dummy Output (JSON)",this.jsonSocket),e=new d.Output("json","JSON",this.jsonSocket);return t.addInput(s).addControl(new D(this.editor,"method",t,!1,"Method",["GET","POST","PUT","PATCH","DELETE","OPTIONS"])).addControl(new E(this.editor,"url",t,!1,"URL","https://example.com/bar")).addControl(new F(this.editor,"cached",t,!1,"Cached (In-Memory)")).addControl(new M(this.editor,"cacheTime",t,!1,"CacheTime (seconds)",30)).addOutput(e)}worker(t,s,e){e.json=s.json.length?s.json[0]:t.data.json,e.url=t.data.url,e.cached=t.data.cached,this.editor.nodes.find(a=>a.id===t.id).controls.get("cacheTime").setValue(t.data.cacheTime,!t.data.cached,!t.data.cached)}}class gt extends ${render(){const{node:t,bindSocket:s,bindControl:e}=this.props,{outputs:a,controls:o,inputs:r,selected:n}=this.state,i=o.filter(h=>h.key==="db").map(h=>h.props.value===""?"DB":h.props.value.toUpperCase())[0],p=o.filter(h=>h.key==="user").map(h=>h.props.value===""?"USER":h.props.value.toUpperCase())[0],y=`${i}_PASS_ON_${p}`;return m("div",{className:`node ${n}`,style:{background:"grey"},children:[l("div",{className:"title",children:t.name}),a.map(h=>m("div",{className:"output",children:[l("div",{className:"output-title",children:h.name}),l(O,{type:"output",socket:h.socket,io:h,innerRef:s})]},h.key)),o.map(h=>m(J,{children:[l(_,{className:"control",control:h,innerRef:e},h.key),h.key==="db"&&m("div",{className:"control",title:"pass",children:[l("label",{style:{color:"white",display:"block",textAlign:"left"},children:"DB_PASS"}),l("textarea",{rows:"3",placeholder:`set ${y} when tuna api starting`,value:"",disabled:!0})]})]})),r.map(h=>m("div",{className:"input",children:[l(O,{type:"input",socket:h.socket,io:h,innerRef:s}),!h.showControl()&&l("div",{className:"input-title",children:h.name}),h.showControl()&&l(_,{className:"input-control",control:h.control,innerRef:e})]},h.key))]})}}class ee extends d.Component{constructor(t,s){super("MySQL");w(this,"path",["New"]);this.data.component=gt,this.jsonSocket=t,this.sqlSocket=s}builder(t){const s=new d.Input("json","Dummy Output (JSON)",this.jsonSocket),e=new d.Output("json","JSON",this.jsonSocket),a=new d.Input("sql","SQL",this.sqlSocket);return t.addInput(a).addInput(s).addControl(new D(this.editor,"tls",t,!1,"TLS",["false","true","skip-verify","preferred"])).addControl(new E(this.editor,"host",t,!1,"HOST","127.0.0.1")).addControl(new E(this.editor,"port",t,!1,"PORT","3306")).addControl(new E(this.editor,"user",t,!1,"USER","guest")).addControl(new E(this.editor,"db",t,!1,"DB_NAME","foo")).addControl(new F(this.editor,"cached",t,!1,"Cached (In-Memory)")).addControl(new M(this.editor,"cacheTime",t,!1,"CacheTime (seconds)",30)).addOutput(e)}worker(t,s,e){e.json=s.json.length?s.json[0]:t.data.json,e.sql=s.sql.length?s.sql[0]:t.data.sql,e.tls=t.data.tls,e.host=t.data.host,e.port=t.data.port,e.user=t.data.user,e.db=t.data.db,e.cached=t.data.cached,e.cacheTime=t.data.cacheTime,this.editor.nodes.find(a=>a.id===t.id).controls.get("cacheTime").setValue(t.data.cacheTime,!t.data.cached,!t.data.cached)}}class se extends d.Component{constructor(t,s){super("PostgreSQL");w(this,"path",["New"]);this.data.component=gt,this.jsonSocket=t,this.sqlSocket=s}builder(t){const s=new d.Input("json","Dummy Output (JSON)",this.jsonSocket),e=new d.Output("json","JSON",this.jsonSocket),a=new d.Input("sql","SQL",this.sqlSocket);return t.addInput(a).addInput(s).addControl(new D(this.editor,"tls",t,!1,"SSLMODE",["disable","require","verify-ca","verify-full"])).addControl(new E(this.editor,"host",t,!1,"HOST","127.0.0.1")).addControl(new E(this.editor,"port",t,!1,"PORT","5432")).addControl(new E(this.editor,"user",t,!1,"USER","guest")).addControl(new E(this.editor,"db",t,!1,"DB_NAME","foo")).addControl(new F(this.editor,"cached",t,!1,"Cached (In-Memory)")).addControl(new M(this.editor,"cacheTime",t,!1,"CacheTime (seconds)",30)).addOutput(e)}worker(t,s,e){e.json=s.json.length?s.json[0]:t.data.json,e.sql=s.sql.length?s.sql[0]:t.data.sql,e.sslmode=t.data.sslmode,e.host=t.data.host,e.port=t.data.port,e.user=t.data.user,e.db=t.data.db,e.cached=t.data.cached,e.cacheTime=t.data.cacheTime,this.editor.nodes.find(a=>a.id===t.id).controls.get("cacheTime").setValue(t.data.cacheTime,!t.data.cached,!t.data.cached)}}class ne extends ${render(){const{node:t,bindSocket:s,bindControl:e}=this.props,{outputs:a,controls:o,inputs:r,selected:n}=this.state;return m("div",{className:`node ${n}`,style:{background:"grey"},children:[l("div",{className:"title",children:t.name}),a.map(i=>m("div",{className:"output",children:[l("div",{className:"output-title",children:i.name}),l(O,{type:"output",socket:i.socket,io:i,innerRef:s})]},i.key)),o.map(i=>l(_,{className:"control",control:i,innerRef:e},i.key)),r.map(i=>m("div",{className:"input",children:[l(O,{type:"input",socket:i.socket,io:i,innerRef:s}),!i.showControl()&&l("div",{className:"input-title",children:i.name}),i.showControl()&&l(_,{className:"input-control",control:i.control,innerRef:e})]},i.key))]})}}class ae extends d.Component{constructor(t,s){super("SQLite");w(this,"path",["New"]);this.data.component=ne,this.jsonSocket=t,this.sqlSocket=s}builder(t){const s=new d.Input("json","Dummy Output (JSON)",this.jsonSocket),e=new d.Output("json","JSON",this.jsonSocket),a=new d.Input("sql","SQL",this.sqlSocket);return t.addInput(a).addInput(s).addControl(new E(this.editor,"filename",t,!1,"FILE_NAME","test.db")).addControl(new F(this.editor,"cached",t,!1,"Cached (In-Memory)")).addControl(new M(this.editor,"cacheTime",t,!1,"CacheTime (seconds)",30)).addOutput(e)}worker(t,s,e){e.json=s.json.length?s.json[0]:t.data.json,e.sql=s.sql.length?s.sql[0]:t.data.sql,e.filename=t.data.filename,e.cached=t.data.cached,e.cacheTime=t.data.cacheTime,this.editor.nodes.find(a=>a.id===t.id).controls.get("cacheTime").setValue(t.data.cacheTime,!t.data.cached,!t.data.cached)}}class oe extends d.Component{constructor(t){super("Request");w(this,"path",["New"]);this.data.component=X,this.jsonSocket=t}builder(t){const s=new d.Input("json","Dummy Output (JSON)",this.jsonSocket),e=new d.Output("json","JSON",this.jsonSocket);return t.addInput(s).addControl(new D(this.editor,"type",t,!1,"Type",["QUERY","COOKIE","BODY"])).addOutput(e)}worker(t,s,e){e.json=s.json.length?s.json[0]:t.data.json,e.type=t.data.type}}class re extends d.Component{constructor(){super("RedirectEndpoint");w(this,"path",["New"]);this.data.component=X}builder(t){var s;return t.data.enabledFlag=(s=t.data.enabledFlag)!=null?s:!0,t.addControl(new F(this.editor,"enabledFlag",t,!1,"Enabled")).addControl(new R(this.editor,"path",t,!1,"Path","/foo")).addControl(new E(this.editor,"url",t,!1,"Url","https://example.com"))}worker(t,s,e){e.enabledFlag=t.data.enabledFlag,e.path=t.data.path,e.url=t.data.url}}async function ie(f){const t=new d.Socket("String value"),s=new d.Socket("Error value"),e=new d.Socket("Json value");e.combineWith(t);const a=new d.Socket("raw Json value");a.combineWith(s),a.combineWith(e),a.combineWith(t);const o=new d.Socket("Template value");o.combineWith(t);const r=new d.Socket("Handlebars value");r.combineWith(o);const n=new d.Socket("Pug value");n.combineWith(o);const i=new d.Socket("HTML value");i.combineWith(t);const p=new d.Socket("HTML Json value");p.combineWith(s),p.combineWith(i),p.combineWith(t);const y=new d.Socket("SQL value"),h=[new Yt(t),new Gt(t,s),new Zt(e),new Dt(a),new $t(p),new Vt(e,o,i),new Ht(r),new Ut(n),new At(y),new te(e),new ee(e,y),new se(e,y),new ae(e,y),new oe(e),new re],b=window.navigator.userAgent.toLowerCase().indexOf("mac os x")!==-1,N=()=>{const{nodeName:c}=document.activeElement;return c==="TEXTAREA"||c==="INPUT"},g=new d.NodeEditor("tuna-mayonnaise@0.0.1",f);g.use(St),g.use(Nt),g.use(bt,{searchBar:!1,delay:100,allocate(c){return c.path},rename(c){return c.name},items:{Arrange(){g.nodes.forEach(c=>{g.trigger("arrange",c)})},Undo(){g.trigger("undo")},Redo(){g.trigger("redo")},Save(){T(()=>import("./index.52d8ea3d.js").then(function(c){return c.i}),[]).then(c=>{c.post("/regist",g.toJSON()).then(()=>T(()=>import("./vendor.7bd79a26.js").then(function(u){return u.q}),[]).then(({toast:u})=>u.success("SAVED :)"))).catch(()=>T(()=>import("./vendor.7bd79a26.js").then(function(u){return u.q}),[]).then(({toast:u})=>u.error("NOT CONNECTED :(")))})},Download(){const c=new Blob([JSON.stringify(g.toJSON())],{type:"application/json; charset=utf-8"});T(()=>import("./FileSaver.min.168ee0a4.js").then(function(u){return u.F}),["assets/FileSaver.min.168ee0a4.js","assets/vendor.7bd79a26.js"]).then(({saveAs:u})=>u(c,"tuna-mayonnaise.json"))},Debug(){console.log(JSON.stringify(g.toJSON()))}}}),g.on("zoom",({source:c})=>c!=="dblclick"&&c==="wheel"&&!N()),g.use(vt,{keyboard:!1}),g.on("keydown",c=>{if(!N()){switch(c.code){case"Delete":case"Backspace":g.selected.each(u=>{g.removeNode(u)}),g.selected.clear();return;case"Space":{const u=g.view.container.getBoundingClientRect(),k=new PointerEvent("contextmenu",{clientX:u.left+u.width/2,clientY:u.top+u.height/2});g.trigger("contextmenu",{e:k,view:g.view});return}}if(c.ctrlKey||b&&c.metaKey)switch(c.code){case"KeyY":g.trigger("redo");return;case"KeyZ":c.shiftKey?g.trigger("redo"):g.trigger("undo");break}}}),g.use(xt),g.use(W,{type:W.DEFAULT,transformer:()=>([c,u,k,S])=>[[c,u],[k,S]],curve:W.curveBundle,options:{vertical:!1,curvature:.4},arrow:{color:"steelblue",marker:"M-5,-10 L-5,10 L20,0 z"}}),g.use(Et),g.use(It,{margin:{x:200,y:50},depth:0});const C=new d.Engine("tuna-mayonnaise@0.0.1");h.forEach(c=>{g.register(c),C.register(c)});const v=await T(()=>import("./index.52d8ea3d.js").then(function(c){return c.i}),[]).then(c=>c.get("/tuna-configuration").then(u=>u.data).catch(()=>(document.getElementsByClassName("rightClick")[0].style.display="block",null)));if(v!==null)await g.fromJSON(v),T(()=>import("./vendor.7bd79a26.js").then(function(c){return c.q}),[]).then(({toast:c})=>c.success("RESUMED :)"));else{const c=await h[0].createNode();c.position=[1e3,200],g.addNode(c)}g.on("showcontextmenu",()=>(document.getElementsByClassName("rightClick")[0].style.display="none",!0)),g.on("process nodecreated noderemoved connectioncreated connectionremoved",async()=>{document.querySelectorAll(".editorTextarea").forEach(c=>{c.addEventListener("wheel",u=>{N()&&(c.parentElement.parentElement.scrollTop+=u.deltaY)})}),await C.abort(),await C.process(g.toJSON())}),g.view.resize(),g.trigger("process"),Ot.zoomAt(g,g.nodes)}const le=()=>m("div",{className:"App",children:[l(Ft,{}),l("img",{className:"rightClick",src:"./right-click.svg",width:"200",height:"200",alt:"RightClick for Menu",style:{display:"none",position:"absolute",top:"25%",left:"25%",pointerEvents:"none"}}),l("div",{style:{width:"100vh",height:"100vh"},ref:f=>f&&ie(f)})]});mt.setAppElement("#root");const ce=document.getElementById("root");jt.render(l(le,{}),ce);
